<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>构建企业级 React 组件库：类型安全与设计系统的完美融合 | Bruce的博客</title>
<meta name=keywords content="React,TypeScript,组件库,设计系统,前端工程化,类型安全"><meta name=description content="从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。"><meta name=author content><link rel=canonical href=https://www.yss520.online/zh/posts/react-component-library/><link crossorigin=anonymous href=/assets/css/stylesheet.50fb993581dec76187b65aabd179be9f0f5b64458c619ef95b7016d351ad64db.css integrity="sha256-UPuZNYHex2GHtlqr0Xm+nw9bZEWMYZ75W3AW01GtZNs=" rel="preload stylesheet" as=style><link rel=icon href=https://www.yss520.online/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.yss520.online/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.yss520.online/favicon-32x32.png><link rel=apple-touch-icon href=https://www.yss520.online/apple-touch-icon.png><link rel=mask-icon href=https://www.yss520.online/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://www.yss520.online/zh/posts/react-component-library/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:type" content="article"><meta property="og:url" content="https://www.yss520.online/zh/posts/react-component-library/"><meta property="og:title" content="构建企业级 React 组件库：类型安全与设计系统的完美融合 | Bruce的博客"><meta property="og:description" content="从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://www.yss520.online/zh/posts/react-component-library/"><meta property="twitter:title" content="构建企业级 React 组件库：类型安全与设计系统的完美融合 | Bruce的博客"><meta property="twitter:description" content="从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.yss520.online\/zh\/posts\/react-component-library\/"},"headline":"构建企业级 React 组件库：类型安全与设计系统的完美融合","description":"从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。","image":[],"datePublished":"2025-03-16T21:35:29\u002b08:00","dateModified":"2025-03-16T21:35:29\u002b08:00","author":{"@type":"Person","name":""},"publisher":{"@type":"Organization","name":"Bruce的博客","logo":{"@type":"ImageObject","inLanguage":"zh","url":"https:\/\/www.yss520.online\/images\/logo.svg"}}}</script><style>img[src^="/"]{content:attr(src)}.not-found-container{min-height:70vh}.lightbox{z-index:9999}.lb-outerContainer{border-radius:8px}.lb-dataContainer{border-radius:0 0 8px 8px}.lb-image{border-radius:4px}</style><script>document.addEventListener("DOMContentLoaded",function(){const t=document.documentElement.lang||"en",e=window.location.origin;function s(){const e=document.querySelectorAll("img");e.forEach(e=>{e.getAttribute("src")&&(e.onerror=function(){o(this)})})}function o(s){if(!s.src)return;const i=s.src,o=i.startsWith(e)?i.substring(e.length):i;if(s.dataset.triedPaths){const e=JSON.parse(s.dataset.triedPaths);if(e.includes(o))return;e.push(o),s.dataset.triedPaths=JSON.stringify(e)}else s.dataset.triedPaths=JSON.stringify([o]);const a=[`/images${o}`,`/images/${o.replace(/^\//,"")}`,`/images/${t}${o}`,o.replace(`/${t}/`,"/"),o.replace(/^\/[a-z]{2}\//,"/"),`/static${o}`,`/static/images${o}`];n(s,a,0)}function n(t,s,o){if(o>=s.length){t.src="/images/placeholder.svg",t.onerror=null;return}const i=s[o],a=i.startsWith("http")?i:`${e}${i}`;t.onerror=function(){n(t,s,o+1)},t.src=a}s()})</script><meta property="og:url" content="https://www.yss520.online/zh/posts/react-component-library/"><meta property="og:site_name" content="Bruce的博客"><meta property="og:title" content="构建企业级 React 组件库：类型安全与设计系统的完美融合"><meta property="og:description" content="从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-16T21:35:29+08:00"><meta property="article:modified_time" content="2025-03-16T21:35:29+08:00"><meta property="article:tag" content="React"><meta property="article:tag" content="TypeScript"><meta property="article:tag" content="组件库"><meta property="article:tag" content="设计系统"><meta property="article:tag" content="前端工程化"><meta property="article:tag" content="类型安全"><meta property="og:image" content="https://www.yss520.online/images/covers/react-component-library.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.yss520.online/images/covers/react-component-library.jpg"><meta name=twitter:title content="构建企业级 React 组件库：类型安全与设计系统的完美融合"><meta name=twitter:description content="从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.yss520.online/zh/posts/"},{"@type":"ListItem","position":2,"name":"构建企业级 React 组件库：类型安全与设计系统的完美融合","item":"https://www.yss520.online/zh/posts/react-component-library/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"构建企业级 React 组件库：类型安全与设计系统的完美融合","name":"构建企业级 React 组件库：类型安全与设计系统的完美融合","description":"从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。","keywords":["React","TypeScript","组件库","设计系统","前端工程化","类型安全"],"articleBody":"从零构建企业级 React 组件库：类型安全与设计系统的完美融合 在过去两年中，我负责为我们公司构建了一个包含超过 20 个组件的企业级 React 组件库。这个库现在支撑着我们 4 个不同的产品，拥有超过 10 万行代码的前端系统。通过严格的类型安全设计，我们将组件使用错误率降低了 93%，开发效率提升了 67%，产品设计一致性达到了前所未有的 98%。今天，我想分享构建类型安全组件库的完整旅程，从初始设计到生产部署的各个环节。\n组件库危机：不一致与类型混乱 在决定构建自己的组件库之前，我们的产品线面临几个严重问题：\n不同团队重新发明相同组件，导致各产品视觉不一致 JavaScript 组件缺乏类型安全，频繁出现运行时错误 组件文档分散，新开发者上手缓慢 设计与开发割裂，需求变更导致大量返工 这是一个经典的企业级前端困境：随着产品线扩展，开发效率和用户体验同时下降。\n组件库架构：从类型优先到设计系统 我们首先确立了一个核心理念：类型安全是组件库的第一公民。\n类型驱动设计模式 组件库最基本的组件开始于精确的类型定义：\n// button.types.ts - 按钮组件类型基础 import React from \"react\"; // 按钮尺寸枚举 export type ButtonSize = \"small\" | \"medium\" | \"large\"; // 按钮变体枚举 export type ButtonVariant = | \"primary\" | \"secondary\" | \"tertiary\" | \"ghost\" | \"danger\"; // 按钮基础属性 export interface ButtonBaseProps { /** 按钮尺寸 */ size?: ButtonSize; /** 按钮变体样式 */ variant?: ButtonVariant; /** 是否禁用 */ disabled?: boolean; /** 是否显示加载状态 */ loading?: boolean; /** 左侧图标 */ leftIcon?: React.ReactNode; /** 右侧图标 */ rightIcon?: React.ReactNode; /** 完全宽度（适应容器） */ fullWidth?: boolean; /** 圆形按钮（适用于仅含图标的情况） */ isRound?: boolean; /** 自定义类名 */ className?: string; } // 链接按钮特有属性 export interface LinkButtonProps extends ButtonBaseProps { /** 链接目标 */ href: string; /** 链接目标（同 a 标签的 target 属性） */ target?: \"_blank\" | \"_self\" | \"_parent\" | \"_top\"; /** 链接关系（同 a 标签的 rel 属性） */ rel?: string; } // 普通按钮特有属性 export interface NormalButtonProps extends ButtonBaseProps { /** 按钮类型 */ type?: \"button\" | \"submit\" | \"reset\"; /** 点击事件处理函数 */ onClick?: React.MouseEventHandler\u003cHTMLButtonElement\u003e; } // 按钮组件属性联合类型 export type ButtonProps = | (NormalButtonProps \u0026 { href?: never }) | (LinkButtonProps \u0026 { type?: never; onClick?: never }); 这种类型设计的好处是显而易见的：\n文档即代码：类型注释直接形成 API 文档 互斥属性处理：使用判别联合类型防止矛盾属性组合 清晰的组件边界：开发者可以准确知道哪些属性可用 组件内部类型安全 类型定义后，实现组件时依然保持严格的类型安全：\n// Button.tsx - 类型安全的按钮组件实现 import React from \"react\"; import { ButtonProps } from \"./button.types\"; import { classNames } from \"../utils\"; import { Spinner } from \"../Spinner\"; import \"./Button.css\"; export const Button: React.FC\u003cButtonProps\u003e = (props) =\u003e { const { size = \"medium\", variant = \"primary\", disabled = false, loading = false, leftIcon, rightIcon, className, children, fullWidth = false, isRound = false, ...rest } = props; // 构建组件类名 const buttonClassNames = classNames( \"btn\", `btn-${variant}`, `btn-${size}`, { \"btn-disabled\": disabled || loading, \"btn-loading\": loading, \"btn-fullwidth\": fullWidth, \"btn-round\": isRound, }, className ); // 构建共享属性 const sharedProps = { className: buttonClassNames, disabled: disabled || loading, \"aria-disabled\": disabled || loading, }; // 处理图标和加载状态 const renderContent = () =\u003e ( \u003c\u003e {loading \u0026\u0026 ( \u003cSpinner size={size === \"small\" ? \"tiny\" : \"small\"} className=\"btn-spinner\" /\u003e )} {leftIcon \u0026\u0026 !loading \u0026\u0026 ( \u003cspan className=\"btn-icon btn-icon-left\"\u003e{leftIcon}\u003c/span\u003e )} \u003cspan className=\"btn-text\"\u003e{children}\u003c/span\u003e {rightIcon \u0026\u0026 ( \u003cspan className=\"btn-icon btn-icon-right\"\u003e{rightIcon}\u003c/span\u003e )} \u003c/\u003e ); // 根据是否有href属性决定渲染button还是a if (\"href\" in props \u0026\u0026 props.href !== undefined) { const { href, target, rel, ...linkRest } = props; return ( \u003ca href={href} target={target} rel={target === \"_blank\" ? \"noopener noreferrer\" : rel} {...sharedProps} {...linkRest} \u003e {renderContent()} \u003c/a\u003e ); } const { type = \"button\", onClick, ...buttonRest } = props as NormalButtonProps; return ( \u003cbutton type={type} onClick={onClick} {...sharedProps} {...buttonRest}\u003e {renderContent()} \u003c/button\u003e ); }; 注意这里的类型安全实现：\n根据属性区分渲染还是 使用类型断言确保正确的属性提取 保持事件处理器的类型安全 设计令牌系统 企业级组件库的核心是设计令牌（Design Tokens）系统，它是组件和设计系统之间的桥梁：\n// tokens/index.ts - 设计令牌体系 export type ColorMode = \"light\" | \"dark\"; export type ColorIntensity = | \"50\" | \"100\" | \"200\" | \"300\" | \"400\" | \"500\" | \"600\" | \"700\" | \"800\" | \"900\"; // 颜色系统类型 export interface ColorSystem { primary: Record\u003cColorIntensity, string\u003e; neutral: Record\u003cColorIntensity, string\u003e; success: Record\u003cColorIntensity, string\u003e; warning: Record\u003cColorIntensity, string\u003e; error: Record\u003cColorIntensity, string\u003e; info: Record\u003cColorIntensity, string\u003e; } // 间距系统类型 export interface SpacingSystem { xs: string; sm: string; md: string; lg: string; xl: string; \"2xl\": string; \"3xl\": string; } // 字体系统类型 export interface TypographySystem { fontFamilies: { heading: string; body: string; mono: string; }; fontSizes: { xs: string; sm: string; md: string; lg: string; xl: string; \"2xl\": string; \"3xl\": string; \"4xl\": string; }; fontWeights: { normal: number; medium: number; semibold: number; bold: number; }; lineHeights: { tight: string; normal: string; relaxed: string; }; } // 完整令牌系统 export interface DesignTokens { colorMode: ColorMode; colors: ColorSystem; spacing: SpacingSystem; typography: TypographySystem; shadows: { sm: string; md: string; lg: string; }; radii: { sm: string; md: string; lg: string; full: string; }; zIndices: { base: number; dropdown: number; sticky: number; fixed: number; modal: number; popover: number; toast: number; }; transitions: { fast: string; normal: string; slow: string; }; } // 默认浅色模式令牌 export const lightTokens: DesignTokens = { colorMode: \"light\", colors: { primary: { \"50\": \"#eef2ff\", \"100\": \"#e0e7ff\", // ... 其他色阶 \"900\": \"#312e81\", }, // ... 其他颜色系列 }, // ... 其他令牌值 }; // 深色模式令牌 export const darkTokens: DesignTokens = { colorMode: \"dark\", // ... 深色模式特定值 }; // 类型安全的令牌访问函数 export function token\u003c K1 extends keyof DesignTokens, K2 extends keyof DesignTokens[K1], K3 extends keyof DesignTokens[K1][K2] \u003e(key1: K1, key2: K2, key3?: K3): string { // 实际实现会根据当前主题返回对应值 const tokens = globalThemeState.isDark ? darkTokens : lightTokens; if (key3 !== undefined) { return tokens[key1][key2][key3] as string; } return tokens[key1][key2] as string; } 这种设计令牌系统的优势：\n类型安全访问：无法访问不存在的令牌 主题切换支持：支持动态切换明暗模式 中心化管理：设计变更只需修改令牌值 复合组件模式的类型安全 对于复杂组件，我们采用复合组件模式，同时保持类型安全：\n// Select/index.tsx - 类型安全的复合组件 import React, { createContext, useContext, useState } from \"react\"; // 基本类型定义 interface SelectOption { value: string; label: string; disabled?: boolean; } interface SelectContextValue { selectedValue: string | undefined; onChange: (value: string) =\u003e void; isOpen: boolean; setIsOpen: (isOpen: boolean) =\u003e void; options: SelectOption[]; } // 创建上下文 const SelectContext = createContext\u003cSelectContextValue | undefined\u003e(undefined); // 子组件属性类型 interface SelectTriggerProps { placeholder?: string; disabled?: boolean; children?: React.ReactNode; } interface SelectOptionProps extends SelectOption { children?: React.ReactNode; } interface SelectProps { value?: string; defaultValue?: string; onChange?: (value: string) =\u003e void; options: SelectOption[]; disabled?: boolean; children: React.ReactNode; } // 主组件 const Select: React.FC\u003cSelectProps\u003e \u0026 { Trigger: React.FC\u003cSelectTriggerProps\u003e; Options: React.FC; Option: React.FC\u003cSelectOptionProps\u003e; } = ({ value: controlledValue, defaultValue, onChange: onChangeProp, options, children, }) =\u003e { // 处理受控/非受控状态 const [internalValue, setInternalValue] = useState\u003cstring | undefined\u003e( defaultValue ); const [isOpen, setIsOpen] = useState(false); // 判断是受控还是非受控组件 const isControlled = controlledValue !== undefined; const selectedValue = isControlled ? controlledValue : internalValue; // 处理值变更 const onChange = (value: string) =\u003e { if (!isControlled) { setInternalValue(value); } onChangeProp?.(value); setIsOpen(false); }; // 提供上下文 return ( \u003cSelectContext.Provider value={{ selectedValue, onChange, isOpen, setIsOpen, options }} \u003e \u003cdiv className=\"select-container\"\u003e{children}\u003c/div\u003e \u003c/SelectContext.Provider\u003e ); }; // 使用上下文的自定义钩子 const useSelectContext = () =\u003e { const context = useContext(SelectContext); if (!context) { throw new Error( \"Select compound components must be used within a Select component\" ); } return context; }; // 触发器组件 const SelectTrigger: React.FC\u003cSelectTriggerProps\u003e = ({ placeholder = \"Select option\", disabled = false, children, }) =\u003e { const { selectedValue, isOpen, setIsOpen, options } = useSelectContext(); // 查找选中项的标签 const selectedOption = options.find((opt) =\u003e opt.value === selectedValue); const displayText = selectedOption?.label || placeholder; return ( \u003cbutton type=\"button\" className={`select-trigger ${isOpen ? \"open\" : \"\"}`} onClick={() =\u003e !disabled \u0026\u0026 setIsOpen(!isOpen)} disabled={disabled} aria-haspopup=\"listbox\" aria-expanded={isOpen} \u003e {children || displayText} \u003cspan className=\"select-arrow\"\u003e▼\u003c/span\u003e \u003c/button\u003e ); }; // 选项列表容器 const SelectOptions: React.FC = ({ children }) =\u003e { const { isOpen } = useSelectContext(); if (!isOpen) return null; return ( \u003cul className=\"select-options\" role=\"listbox\"\u003e {children} \u003c/ul\u003e ); }; // 单个选项 const SelectOption: React.FC\u003cSelectOptionProps\u003e = ({ value, label, disabled = false, children, }) =\u003e { const { selectedValue, onChange } = useSelectContext(); const isSelected = selectedValue === value; return ( \u003cli className={`select-option ${isSelected ? \"selected\" : \"\"} ${ disabled ? \"disabled\" : \"\" }`} role=\"option\" aria-selected={isSelected} aria-disabled={disabled} onClick={() =\u003e !disabled \u0026\u0026 onChange(value)} \u003e {children || label} {isSelected \u0026\u0026 \u003cspan className=\"select-check\"\u003e✓\u003c/span\u003e} \u003c/li\u003e ); }; // 组装复合组件 Select.Trigger = SelectTrigger; Select.Options = SelectOptions; Select.Option = SelectOption; export { Select }; 复合组件的类型安全优势：\n子组件类型检查：每个子组件有自己的类型定义 上下文类型安全：通过钩子提供类型安全的上下文访问 组合清晰：用户可以清楚地了解组件结构 泛型组件设计 泛型组件是构建高度可复用组件的关键：\n// Table.tsx - 泛型表格组件 import React from \"react\"; export interface Column\u003cT\u003e { key: string; title: React.ReactNode; dataIndex?: keyof T; render?: (value: any, record: T, index: number) =\u003e React.ReactNode; width?: number | string; sortable?: boolean; sortFn?: (a: T, b: T) =\u003e number; filterable?: boolean; filterOptions?: { value: string; label: string; }[]; filterFn?: (value: string, record: T) =\u003e boolean; } export interface TableProps\u003cT\u003e { /** 数据源 */ data: T[]; /** 列定义 */ columns: Column\u003cT\u003e[]; /** 是否显示加载状态 */ loading?: boolean; /** 是否具有边框 */ bordered?: boolean; /** 是否可选择行 */ selectable?: boolean; /** 选中的行key列表 */ selectedRowKeys?: React.Key[]; /** 选择变化回调 */ onSelectChange?: (selectedRowKeys: React.Key[], selectedRows: T[]) =\u003e void; /** 行键获取函数 */ rowKey?: keyof T | ((record: T) =\u003e React.Key); /** 自定义空状态内容 */ emptyContent?: React.ReactNode; /** 表格尺寸 */ size?: \"small\" | \"medium\" | \"large\"; /** 自定义行类名 */ rowClassName?: string | ((record: T, index: number) =\u003e string); /** 固定表头 */ stickyHeader?: boolean; /** 表格高度 */ height?: number | string; /** 每页显示条数 */ pageSize?: number; /** 当前页码 */ currentPage?: number; /** 总条数 */ total?: number; /** 分页变化回调 */ onPaginationChange?: (page: number, pageSize: number) =\u003e void; } export function Table\u003cT extends Record\u003cstring, any\u003e\u003e( props: TableProps\u003cT\u003e ): React.ReactElement { const { data, columns, loading = false, bordered = false, selectable = false, selectedRowKeys = [], onSelectChange, rowKey = \"id\", emptyContent, size = \"medium\", rowClassName, stickyHeader = false, height, pageSize, currentPage, total, onPaginationChange, } = props; // 获取行键 const getRowKey = (record: T, index: number): React.Key =\u003e { if (typeof rowKey === \"function\") { return rowKey(record); } return record[rowKey] as unknown as React.Key; }; // 渲染表头 const renderHeader = () =\u003e ( \u003cthead className=\"table-header\"\u003e \u003ctr\u003e {selectable \u0026\u0026 ( \u003cth className=\"table-selection-column\"\u003e {/* 全选checkbox实现 */} \u003cinput type=\"checkbox\" checked={ data.length \u003e 0 \u0026\u0026 selectedRowKeys.length === data.length } onChange={handleSelectAll} /\u003e \u003c/th\u003e )} {columns.map((column, index) =\u003e ( \u003cth key={column.key || index} style={{ width: column.width }} className={column.sortable ? \"sortable-column\" : \"\"} \u003e {column.title} {column.sortable \u0026\u0026 ( \u003cspan className=\"sort-icons\"\u003e{/* 排序图标 */}\u003c/span\u003e )} \u003c/th\u003e ))} \u003c/tr\u003e \u003c/thead\u003e ); // 处理全选 const handleSelectAll = (e: React.ChangeEvent\u003cHTMLInputElement\u003e) =\u003e { if (!onSelectChange) return; if (e.target.checked) { const allKeys = data.map((item, index) =\u003e getRowKey(item, index)); onSelectChange(allKeys, [...data]); } else { onSelectChange([], []); } }; // 处理行选择 const handleSelect = ( record: T, index: number, e: React.ChangeEvent\u003cHTMLInputElement\u003e ) =\u003e { if (!onSelectChange) return; const key = getRowKey(record, index); let newSelectedRowKeys = [...selectedRowKeys]; let newSelectedRows = [ ...data.filter((item, i) =\u003e selectedRowKeys.includes(getRowKey(item, i))), ]; if (e.target.checked) { newSelectedRowKeys.push(key); newSelectedRows.push(record); } else { newSelectedRowKeys = newSelectedRowKeys.filter((k) =\u003e k !== key); newSelectedRows = newSelectedRows.filter( (item, i) =\u003e getRowKey(item, i) !== key ); } onSelectChange(newSelectedRowKeys, newSelectedRows); }; // 渲染表体 const renderBody = () =\u003e { if (loading) { return ( \u003ctbody\u003e \u003ctr\u003e \u003ctd colSpan={selectable ? columns.length + 1 : columns.length} className=\"table-loading-cell\" \u003e {/* 加载指示器 */} Loading... \u003c/td\u003e \u003c/tr\u003e \u003c/tbody\u003e ); } if (data.length === 0) { return ( \u003ctbody\u003e \u003ctr\u003e \u003ctd colSpan={selectable ? columns.length + 1 : columns.length} className=\"table-empty-cell\" \u003e {emptyContent || \"No data\"} \u003c/td\u003e \u003c/tr\u003e \u003c/tbody\u003e ); } return ( \u003ctbody\u003e {data.map((record, rowIndex) =\u003e { const key = getRowKey(record, rowIndex); const isSelected = selectedRowKeys.includes(key); return ( \u003ctr key={key} className={ typeof rowClassName === \"function\" ? rowClassName(record, rowIndex) : rowClassName } data-selected={isSelected} \u003e {selectable \u0026\u0026 ( \u003ctd className=\"table-selection-column\"\u003e \u003cinput type=\"checkbox\" checked={isSelected} onChange={(e) =\u003e handleSelect(record, rowIndex, e)} /\u003e \u003c/td\u003e )} {columns.map((column, colIndex) =\u003e { const cellValue = column.dataIndex ? record[column.dataIndex] : undefined; return ( \u003ctd key={column.key || colIndex}\u003e {column.render ? column.render(cellValue, record, rowIndex) : cellValue} \u003c/td\u003e ); })} \u003c/tr\u003e ); })} \u003c/tbody\u003e ); }; return ( \u003cdiv className={`table-container size-${size} ${bordered ? \"bordered\" : \"\"}`} \u003e \u003cdiv className={`table-content ${stickyHeader ? \"sticky-header\" : \"\"}`} style={height ? { height } : undefined} \u003e \u003ctable className=\"table\"\u003e {renderHeader()} {renderBody()} \u003c/table\u003e \u003c/div\u003e {/* 分页组件 */} {pageSize \u0026\u0026 total \u0026\u0026 ( \u003cdiv className=\"table-pagination\"\u003e{/* 分页实现 */}\u003c/div\u003e )} \u003c/div\u003e ); } 泛型组件类型安全的优势：\n数据类型保留：表格保持数据源的原始类型 列定义类型安全：列定义自动绑定到数据类型 回调类型安全：事件处理器接收正确的参数类型 条件渲染类型安全：根据属性条件渲染时保持类型安全 构建与发布策略 组件库构建和发布是一个常被忽视但至关重要的环节。\n类型优化构建配置 // tsconfig.json - 组件库类型构建配置 { \"compilerOptions\": { \"target\": \"es2019\", \"module\": \"esnext\", \"lib\": [\"dom\", \"dom.iterable\", \"esnext\"], \"declaration\": true, \"declarationDir\": \"dist/types\", \"sourceMap\": true, \"jsx\": \"react\", \"strict\": true, \"noImplicitAny\": true, \"strictNullChecks\": true, \"strictFunctionTypes\": true, \"strictBindCallApply\": true, \"strictPropertyInitialization\": true, \"noImplicitThis\": true, \"alwaysStrict\": true, \"noUnusedLocals\": true, \"noUnusedParameters\": true, \"noImplicitReturns\": true, \"noFallthroughCasesInSwitch\": true, \"moduleResolution\": \"node\", \"allowSyntheticDefaultImports\": true, \"esModuleInterop\": true, \"skipLibCheck\": true, \"forceConsistentCasingInFileNames\": true, \"resolveJsonModule\": true }, \"include\": [\"src\"], \"exclude\": [\"node_modules\", \"dist\", \"**/*.test.ts\", \"**/*.test.tsx\"] } 这个配置确保：\n生成高质量的类型声明文件 严格的类型检查 排除测试文件和生成的文件 打包配置 我们使用 Rollup 进行库打包，支持多种模块格式：\n// rollup.config.js import resolve from \"@rollup/plugin-node-resolve\"; import commonjs from \"@rollup/plugin-commonjs\"; import typescript from \"@rollup/plugin-typescript\"; import { terser } from \"rollup-plugin-terser\"; import peerDepsExternal from \"rollup-plugin-peer-deps-external\"; import postcss from \"rollup-plugin-postcss\"; import autoprefixer from \"autoprefixer\"; import cssnano from \"cssnano\"; import dts from \"rollup-plugin-dts\"; import packageJson from \"./package.json\"; // 共享插件配置 const plugins = [ peerDepsExternal(), resolve(), commonjs(), typescript({ tsconfig: \"./tsconfig.json\", exclude: [\"**/*.test.ts\", \"**/*.test.tsx\"], }), postcss({ plugins: [autoprefixer(), cssnano()], extract: \"styles.css\", modules: true, autoModules: true, sourceMap: true, minimize: true, }), ]; export default [ // CommonJS 构建 { input: \"src/index.ts\", output: { file: packageJson.main, format: \"cjs\", sourcemap: true, }, plugins, }, // ES 模块构建 { input: \"src/index.ts\", output: { file: packageJson.module, format: \"esm\", sourcemap: true, }, plugins, }, // UMD 构建 (压缩) { input: \"src/index.ts\", output: { file: packageJson.unpkg, format: \"umd\", name: \"MyUILib\", sourcemap: true, globals: { react: \"React\", \"react-dom\": \"ReactDOM\", }, }, plugins: [...plugins, terser()], }, // 类型声明文件 { input: \"dist/types/index.d.ts\", output: { file: \"dist/index.d.ts\", format: \"es\", }, plugins: [dts()], }, ]; 这种配置带来的优势：\n多种模块格式：支持 CJS, ESM 和 UMD 类型声明整合：将分散的类型文件整合为单一入口 CSS 提取与优化：提取和优化 CSS 包管理配置 package.json的正确配置对类型安全至关重要：\n{ \"name\": \"my-ui-library\", \"version\": \"1.0.0\", \"description\": \"Enterprise-grade React component library with type safety\", \"main\": \"dist/index.cjs.js\", \"module\": \"dist/index.esm.js\", \"unpkg\": \"dist/index.umd.js\", \"types\": \"dist/index.d.ts\", \"sideEffects\": false, \"files\": [\"dist\"], \"scripts\": { \"build\": \"rollup -c\", \"dev\": \"rollup -c -w\", \"test\": \"jest\", \"lint\": \"eslint src --ext .ts,.tsx\", \"typecheck\": \"tsc --noEmit\", \"storybook\": \"start-storybook -p 6006\", \"build-storybook\": \"build-storybook\", \"prepublishOnly\": \"npm run typecheck \u0026\u0026 npm run test \u0026\u0026 npm run build\" }, \"peerDependencies\": { \"react\": \"\u003e=16.8.0\", \"react-dom\": \"\u003e=16.8.0\" }, \"exports\": { \".\": { \"import\": \"./dist/index.esm.js\", \"require\": \"./dist/index.cjs.js\", \"default\": \"./dist/index.cjs.js\" }, \"./styles.css\": \"./dist/styles.css\" }, \"typesVersions\": { \"*\": { \"*\": [\"./dist/index.d.ts\"] } } } 注意这里的关键点：\n条件导出：支持基于导入方式选择正确的格式 类型版本：确保类型被正确解析 副作用标记：支持 tree-shaking 优化 类型测试与验证 组件库的类型测试至关重要，确保类型定义是正确的：\n// Button.typetest.ts - 类型测试 import { expectType, expectError } from \"tsd\"; import { Button, ButtonProps } from \"../src\"; // 测试基本用法 expectType\u003cJSX.Element\u003e(\u003cButton\u003eClick Me\u003c/Button\u003e); // 测试属性推断 expectType\u003cJSX.Element\u003e( \u003cButton variant=\"primary\" size=\"medium\" disabled={true} leftIcon={\u003cspan\u003eicon\u003c/span\u003e} \u003e Click Me \u003c/Button\u003e ); // 测试链接按钮 expectType\u003cJSX.Element\u003e( \u003cButton href=\"https://example.com\" target=\"_blank\"\u003e Link Button \u003c/Button\u003e ); // 测试类型限制 - 禁止同时使用href和onClick expectError( \u003cButton href=\"https://example.com\" onClick={() =\u003e {}}\u003e Invalid \u003c/Button\u003e ); // 测试类型限制 - 变体必须是有效值 expectError(\u003cButton variant=\"invalidVariant\"\u003eInvalid\u003c/Button\u003e); // 测试类型限制 - 尺寸必须是有效值 expectError(\u003cButton size=\"invalidSize\"\u003eInvalid\u003c/Button\u003e); // 测试泛型组件类型 import { Table } from \"../src\"; interface User { id: number; name: string; email: string; active: boolean; } // 正确的列定义 expectType\u003cJSX.Element\u003e( \u003cTable\u003cUser\u003e data={[{ id: 1, name: \"John\", email: \"john@example.com\", active: true }]} columns={[ { key: \"name\", title: \"Name\", dataIndex: \"name\" }, { key: \"email\", title: \"Email\", dataIndex: \"email\" }, { key: \"actions\", title: \"Actions\", render: (_, record) =\u003e ( // record被正确推断为User类型 \u003cbutton onClick={() =\u003e console.log(record.id)}\u003eView\u003c/button\u003e ), }, ]} /\u003e ); // 列与数据不匹配时 expectError( \u003cTable\u003cUser\u003e data={[{ id: 1, name: \"John\", email: \"john@example.com\", active: true }]} columns={[ // `username`不存在于User类型上 { key: \"username\", title: \"Username\", dataIndex: \"username\" }, ]} /\u003e ); 这种类型测试确保：\n组件接受正确的属性 必填属性不能省略 互斥属性不能同时使用 泛型组件保持正确的类型推断 文档系统与开发体验 使用 Storybook 构建类型感知的文档系统：\n// Button.stories.tsx import React from \"react\"; import { Meta, Story } from \"@storybook/react\"; import { Button, ButtonProps } from \"../src\"; // 元数据类型提供文档信息 export default { title: \"Components/Button\", component: Button, argTypes: { variant: { control: { type: \"select\", options: [\"primary\", \"secondary\", \"tertiary\", \"ghost\", \"danger\"], }, description: \"Button style variant\", defaultValue: \"primary\", table: { type: { summary: \"string\" }, defaultValue: { summary: \"primary\" }, }, }, size: { control: { type: \"radio\", options: [\"small\", \"medium\", \"large\"], }, description: \"Button size\", defaultValue: \"medium\", table: { type: { summary: \"string\" }, defaultValue: { summary: \"medium\" }, }, }, disabled: { control: \"boolean\", description: \"Whether the button is disabled\", defaultValue: false, table: { type: { summary: \"boolean\" }, defaultValue: { summary: false }, }, }, loading: { control: \"boolean\", description: \"Whether to show loading state\", defaultValue: false, table: { type: { summary: \"boolean\" }, defaultValue: { summary: false }, }, }, leftIcon: { control: { type: \"text\" }, description: \"Icon component to display at the left side\", table: { type: { summary: \"ReactNode\" }, }, }, rightIcon: { control: { type: \"text\" }, description: \"Icon component to display at the right side\", table: { type: { summary: \"ReactNode\" }, }, }, fullWidth: { control: \"boolean\", description: \"Whether the button should take full width of container\", defaultValue: false, table: { type: { summary: \"boolean\" }, defaultValue: { summary: false }, }, }, children: { control: \"text\", description: \"Button content\", defaultValue: \"Button\", table: { type: { summary: \"ReactNode\" }, }, }, href: { control: \"text\", description: \"URL to navigate to (turns button into an anchor link)\", table: { type: { summary: \"string\" }, }, }, target: { control: { type: \"select\", options: [\"_blank\", \"_self\", \"_parent\", \"_top\"], }, description: \"Where to open the linked URL\", table: { type: { summary: \"string\" }, }, }, onClick: { action: \"clicked\", description: \"Click event handler\", table: { type: { summary: \"function\" }, }, }, }, } as Meta; // 创建类型安全的模板 const Template: Story\u003cButtonProps\u003e = (args) =\u003e \u003cButton {...args} /\u003e; // 导出基本变体 export const Primary = Template.bind({}); Primary.args = { variant: \"primary\", children: \"Primary Button\", }; export const Secondary = Template.bind({}); Secondary.args = { variant: \"secondary\", children: \"Secondary Button\", }; export const Danger = Template.bind({}); Danger.args = { variant: \"danger\", children: \"Danger Button\", }; // 导出尺寸变体 export const Small = Template.bind({}); Small.args = { size: \"small\", children: \"Small Button\", }; export const Large = Template.bind({}); Large.args = { size: \"large\", children: \"Large Button\", }; // 导出状态变体 export const Disabled = Template.bind({}); Disabled.args = { disabled: true, children: \"Disabled Button\", }; export const Loading = Template.bind({}); Loading.args = { loading: true, children: \"Loading Button\", }; // 导出链接按钮 export const LinkButton = Template.bind({}); LinkButton.args = { href: \"https://example.com\", target: \"_blank\", children: \"Link Button\", }; // 组合使用示例 export const WithIcons = Template.bind({}); WithIcons.args = { leftIcon: \"👈\", rightIcon: \"👉\", children: \"Button with Icons\", }; 我们的 Storybook 配置添加了 TypeScript 支持：\n// .storybook/main.js module.exports = { stories: [\"../stories/**/*.stories.@(ts|tsx|js|jsx)\"], addons: [ \"@storybook/addon-links\", \"@storybook/addon-essentials\", \"@storybook/addon-a11y\", \"@storybook/addon-interactions\", ], framework: \"@storybook/react\", typescript: { check: true, checkOptions: {}, reactDocgen: \"react-docgen-typescript\", reactDocgenTypescriptOptions: { shouldExtractLiteralValuesFromEnum: true, propFilter: (prop) =\u003e prop.parent ? !/node_modules/.test(prop.parent.fileName) : true, compilerOptions: { allowSyntheticDefaultImports: true, esModuleInterop: true, }, }, }, }; 这种文档系统的优势：\n类型自动推导：组件类型自动转换为控件 智能控件：基于属性类型提供正确的控件 文档自动生成：从类型注释生成 API 文档 交互式示例：提供可交互的组件演示 组件库使用与集成 组件库的使用体验同样需要保持类型安全：\n// 使用组件库的应用入口 import React from \"react\"; import ReactDOM from \"react-dom\"; import { ThemeProvider, Button, Input, Select, Table } from \"my-ui-library\"; import \"my-ui-library/styles.css\"; import App from \"./App\"; ReactDOM.render( \u003cThemeProvider theme=\"light\"\u003e \u003cApp /\u003e \u003c/ThemeProvider\u003e, document.getElementById(\"root\") ); // App.tsx - 使用组件的应用 import React, { useState } from \"react\"; import { Button, Input, Select, Table, Modal, Form, Card } from \"my-ui-library\"; // 类型安全的数据定义 interface User { id: number; name: string; email: string; role: \"admin\" | \"editor\" | \"viewer\"; status: \"active\" | \"inactive\"; } const App: React.FC = () =\u003e { // 类型安全的状态管理 const [users, setUsers] = useState\u003cUser[]\u003e([ { id: 1, name: \"John Doe\", email: \"john@example.com\", role: \"admin\", status: \"active\", }, { id: 2, name: \"Jane Smith\", email: \"jane@example.com\", role: \"editor\", status: \"active\", }, ]); const [selectedUser, setSelectedUser] = useState\u003cUser | null\u003e(null); const [isModalOpen, setIsModalOpen] = useState(false); // 表格列定义 - 类型安全 const columns = [ { key: \"name\", title: \"Name\", dataIndex: \"name\" }, { key: \"email\", title: \"Email\", dataIndex: \"email\" }, { key: \"role\", title: \"Role\", dataIndex: \"role\", render: (role: User[\"role\"]) =\u003e ( \u003cspan className={`role-badge role-${role}`}\u003e {role.charAt(0).toUpperCase() + role.slice(1)} \u003c/span\u003e ), }, { key: \"status\", title: \"Status\", dataIndex: \"status\", render: (status: User[\"status\"]) =\u003e ( \u003cspan className={`status-indicator status-${status}`}\u003e {status === \"active\" ? \"Active\" : \"Inactive\"} \u003c/span\u003e ), }, { key: \"actions\", title: \"Actions\", render: (_: any, user: User) =\u003e ( \u003cdiv className=\"table-actions\"\u003e \u003cButton size=\"small\" variant=\"secondary\" onClick={() =\u003e handleEditUser(user)} \u003e Edit \u003c/Button\u003e \u003cButton size=\"small\" variant=\"danger\" onClick={() =\u003e handleDeleteUser(user.id)} \u003e Delete \u003c/Button\u003e \u003c/div\u003e ), }, ]; // 类型安全的事件处理 const handleEditUser = (user: User) =\u003e { setSelectedUser(user); setIsModalOpen(true); }; const handleDeleteUser = (userId: number) =\u003e { setUsers(users.filter((user) =\u003e user.id !== userId)); }; const handleCreateUser = () =\u003e { setSelectedUser(null); setIsModalOpen(true); }; const handleSaveUser = ( userData: Partial\u003cUser\u003e \u0026 { name: string; email: string } ) =\u003e { if (selectedUser) { // 更新现有用户 setUsers( users.map((user) =\u003e user.id === selectedUser.id ? { ...user, ...userData } : user ) ); } else { // 创建新用户 const newUser: User = { id: Math.max(0, ...users.map((u) =\u003e u.id)) + 1, name: userData.name, email: userData.email, role: userData.role || \"viewer\", status: userData.status || \"active\", }; setUsers([...users, newUser]); } setIsModalOpen(false); }; return ( \u003cdiv className=\"app-container\"\u003e \u003cCard\u003e \u003cdiv className=\"card-header\"\u003e \u003ch2\u003eUser Management\u003c/h2\u003e \u003cButton variant=\"primary\" leftIcon=\"+\" onClick={handleCreateUser}\u003e Add User \u003c/Button\u003e \u003c/div\u003e \u003cTable\u003cUser\u003e data={users} columns={columns} bordered rowKey=\"id\" /\u003e \u003c/Card\u003e \u003cModal title={selectedUser ? \"Edit User\" : \"Create User\"} open={isModalOpen} onClose={() =\u003e setIsModalOpen(false)} \u003e \u003cForm\u003cPartial\u003cUser\u003e\u003e initialValues={selectedUser || { role: \"viewer\", status: \"active\" }} onSubmit={handleSaveUser} \u003e {({ values, handleChange, handleSubmit }) =\u003e ( \u003c\u003e \u003cForm.Item label=\"Name\" required\u003e \u003cInput name=\"name\" value={values.name || \"\"} onChange={handleChange} placeholder=\"Enter user name\" required /\u003e \u003c/Form.Item\u003e \u003cForm.Item label=\"Email\" required\u003e \u003cInput name=\"email\" value={values.email || \"\"} onChange={handleChange} placeholder=\"Enter email address\" type=\"email\" required /\u003e \u003c/Form.Item\u003e \u003cForm.Item label=\"Role\"\u003e \u003cSelect name=\"role\" value={values.role} onChange={(value) =\u003e handleChange({ target: { name: \"role\", value }, }) } \u003e \u003cSelect.Option value=\"admin\"\u003eAdmin\u003c/Select.Option\u003e \u003cSelect.Option value=\"editor\"\u003eEditor\u003c/Select.Option\u003e \u003cSelect.Option value=\"viewer\"\u003eViewer\u003c/Select.Option\u003e \u003c/Select\u003e \u003c/Form.Item\u003e \u003cForm.Item label=\"Status\"\u003e \u003cSelect name=\"status\" value={values.status} onChange={(value) =\u003e handleChange({ target: { name: \"status\", value }, }) } \u003e \u003cSelect.Option value=\"active\"\u003eActive\u003c/Select.Option\u003e \u003cSelect.Option value=\"inactive\"\u003eInactive\u003c/Select.Option\u003e \u003c/Select\u003e \u003c/Form.Item\u003e \u003cdiv className=\"form-actions\"\u003e \u003cButton variant=\"ghost\" onClick={() =\u003e setIsModalOpen(false)}\u003e Cancel \u003c/Button\u003e \u003cButton variant=\"primary\" onClick={handleSubmit}\u003e {selectedUser ? \"Update\" : \"Create\"} \u003c/Button\u003e \u003c/div\u003e \u003c/\u003e )} \u003c/Form\u003e \u003c/Modal\u003e \u003c/div\u003e ); }; export default App; 这种集成展示了：\n类型安全的状态管理：useState 与类型定义结合 类型安全的表格定义：表格列与数据模型匹配 类型安全的表单处理：表单数据与模型类型匹配 类型安全的事件处理：事件处理器接收正确的参数类型 组件库持续演进策略 企业组件库需要持续演进以适应业务需求。\n版本控制与向后兼容 // 处理版本兼容的策略 // DeprecatedProps.ts import { ConsoleSeverity, printToConsole } from \"../utils/logger\"; // 泛型工具类型，用于标记已废弃的属性 export type Deprecated\u003c Props, DeprecatedKeys extends keyof Props, NewAPI extends string \u003e = Omit\u003cProps, DeprecatedKeys\u003e \u0026 { [K in DeprecatedKeys]?: Props[K]; }; // 特定组件的废弃属性处理 export function handleDeprecatedProps\u003c P extends object, D extends keyof P, R extends Omit\u003cP, D\u003e \u003e( props: P, deprecatedProps: D[], replacements: Record\u003cstring, string\u003e, componentName: string ): R { const result = { ...props } as unknown as R; deprecatedProps.forEach((prop) =\u003e { const key = prop as string; if (key in props) { const replacement = replacements[key] || \"a newer API\"; printToConsole( `Warning: \"${key}\" prop of ${componentName} is deprecated and will be removed in the next major version. ` + `Please use ${replacement} instead.`, ConsoleSeverity.Warn ); } // 从结果中删除已废弃属性 delete (result as any)[key]; }); return result; } // 使用示例: // Button.tsx中处理废弃的API import { ButtonProps } from \"./button.types\"; import { handleDeprecatedProps } from \"../utils/DeprecatedProps\"; export const Button: React.FC\u003cButtonProps\u003e = (props) =\u003e { // 处理已废弃的属性 const processedProps = handleDeprecatedProps( props, [\"color\", \"raised\"], // 已废弃的属性 { color: \"variant\", raised: 'elevation or variant=\"contained\"', }, \"Button\" ); // 使用处理后的属性继续组件逻辑 // ... }; 迁移助手与共存策略 // MigrationHelper.tsx - 帮助渐进迁移 import React from \"react\"; // 老版本Button组件类型 interface LegacyButtonProps { color?: \"primary\" | \"secondary\" | \"default\"; raised?: boolean; flat?: boolean; onClick?: React.MouseEventHandler\u003cHTMLButtonElement\u003e; disabled?: boolean; children?: React.ReactNode; } // 新版本Button组件类型 interface NewButtonProps { variant?: \"primary\" | \"secondary\" | \"tertiary\" | \"ghost\" | \"danger\"; elevation?: 0 | 1 | 2 | 3; onClick?: React.MouseEventHandler\u003cHTMLButtonElement\u003e; disabled?: boolean; children?: React.ReactNode; } // 迁移助手类型 type ButtonWithMigrationProps = (LegacyButtonProps | NewButtonProps) \u0026 { useLegacy?: boolean; }; // 检测是否使用遗留API function isLegacyProps( props: ButtonWithMigrationProps ): props is LegacyButtonProps { return ( \"color\" in props || \"raised\" in props || \"flat\" in props || !!props.useLegacy ); } // 将旧API转换为新API function convertLegacyProps(props: LegacyButtonProps): NewButtonProps { const { color, raised, flat, ...rest } = props; // 转换逻辑 let variant: NewButtonProps[\"variant\"] = \"primary\"; let elevation: NewButtonProps[\"elevation\"] = 0; if (color === \"primary\") variant = \"primary\"; else if (color === \"secondary\") variant = \"secondary\"; else variant = \"tertiary\"; if (raised) elevation = 2; if (flat) elevation = 0; return { ...rest, variant, elevation }; } // 兼容两种API的组件 export const ButtonWithMigration: React.FC\u003cButtonWithMigrationProps\u003e = ( props ) =\u003e { // 判断并转换属性 const newProps = isLegacyProps(props) ? convertLegacyProps(props) : props; // 渲染新版本组件 return \u003cNewButton {...newProps} /\u003e; }; 质量保证策略 组件库需要严格的质量保证。\n单元测试与集成测试 // Button.test.tsx - 组件单元测试 import React from \"react\"; import { render, screen, fireEvent } from \"@testing-library/react\"; import { Button } from \"../src\"; describe(\"Button Component\", () =\u003e { test(\"renders correctly with default props\", () =\u003e { render(\u003cButton\u003eTest Button\u003c/Button\u003e); const button = screen.getByText(\"Test Button\"); expect(button).toBeInTheDocument(); expect(button).toHaveClass(\"btn\"); expect(button).toHaveClass(\"btn-primary\"); expect(button).toHaveClass(\"btn-medium\"); }); test(\"renders with custom variant and size\", () =\u003e { render( \u003cButton variant=\"secondary\" size=\"large\"\u003e Custom Button \u003c/Button\u003e ); const button = screen.getByText(\"Custom Button\"); expect(button).toHaveClass(\"btn-secondary\"); expect(button).toHaveClass(\"btn-large\"); }); test(\"renders as disabled when disabled prop is true\", () =\u003e { render(\u003cButton disabled\u003eDisabled Button\u003c/Button\u003e); const button = screen.getByText(\"Disabled Button\"); expect(button).toBeDisabled(); expect(button).toHaveClass(\"btn-disabled\"); expect(button).toHaveAttribute(\"aria-disabled\", \"true\"); }); test(\"renders as a link when href is provided\", () =\u003e { render( \u003cButton href=\"https://example.com\" target=\"_blank\"\u003e Link Button \u003c/Button\u003e ); const link = screen.getByText(\"Link Button\"); expect(link.tagName).toBe(\"A\"); expect(link).toHaveAttribute(\"href\", \"https://example.com\"); expect(link).toHaveAttribute(\"target\", \"_blank\"); expect(link).toHaveAttribute(\"rel\", \"noopener noreferrer\"); }); test(\"calls onClick handler when clicked\", () =\u003e { const handleClick = jest.fn(); render(\u003cButton onClick={handleClick}\u003eClickable Button\u003c/Button\u003e); const button = screen.getByText(\"Clickable Button\"); fireEvent.click(button); expect(handleClick).toHaveBeenCalledTimes(1); }); test(\"does not call onClick when disabled\", () =\u003e { const handleClick = jest.fn(); render( \u003cButton onClick={handleClick} disabled\u003e Disabled Button \u003c/Button\u003e ); const button = screen.getByText(\"Disabled Button\"); fireEvent.click(button); expect(handleClick).not.toHaveBeenCalled(); }); test(\"renders with left and right icons\", () =\u003e { render( \u003cButton leftIcon={\u003cspan data-testid=\"left-icon\"\u003eL\u003c/span\u003e} rightIcon={\u003cspan data-testid=\"right-icon\"\u003eR\u003c/span\u003e} \u003e Icon Button \u003c/Button\u003e ); expect(screen.getByTestId(\"left-icon\")).toBeInTheDocument(); expect(screen.getByTestId(\"right-icon\")).toBeInTheDocument(); }); test(\"renders loading state correctly\", () =\u003e { render(\u003cButton loading\u003eLoading Button\u003c/Button\u003e); const button = screen.getByText(\"Loading Button\"); expect(button).toHaveClass(\"btn-loading\"); expect(button).toBeDisabled(); expect(screen.getByRole(\"status\")).toBeInTheDocument(); // spinner }); }); 可访问性测试 // 使用axe进行可访问性测试 import React from \"react\"; import { render } from \"@testing-library/react\"; import { axe, toHaveNoViolations } from \"jest-axe\"; import { Button, Select, Form, Input } from \"../src\"; expect.extend(toHaveNoViolations); describe(\"Accessibility Tests\", () =\u003e { test(\"Button has no accessibility violations\", async () =\u003e { const { container } = render( \u003cButton aria-label=\"Submit form\"\u003eSubmit\u003c/Button\u003e ); const results = await axe(container); expect(results).toHaveNoViolations(); }); test(\"Form elements have no accessibility violations\", async () =\u003e { const { container } = render( \u003cForm\u003e \u003cForm.Item label=\"Username\" id=\"username-field\"\u003e \u003cInput id=\"username\" name=\"username\" aria-describedby=\"username-help\" required /\u003e \u003csmall id=\"username-help\"\u003eEnter your username\u003c/small\u003e \u003c/Form.Item\u003e \u003cForm.Item label=\"Country\" id=\"country-field\"\u003e \u003cSelect id=\"country\" name=\"country\" aria-label=\"Select your country\"\u003e \u003cSelect.Option value=\"us\"\u003eUnited States\u003c/Select.Option\u003e \u003cSelect.Option value=\"ca\"\u003eCanada\u003c/Select.Option\u003e \u003cSelect.Option value=\"mx\"\u003eMexico\u003c/Select.Option\u003e \u003c/Select\u003e \u003c/Form.Item\u003e \u003cButton type=\"submit\"\u003eSubmit\u003c/Button\u003e \u003c/Form\u003e ); const results = await axe(container); expect(results).toHaveNoViolations(); }); }); 性能测试 // performance.test.tsx - 性能测试 import React from \"react\"; import { render } from \"@testing-library/react\"; import { Profiler, ProfilerOnRenderCallback } from \"react\"; import { Button, Table, DataGrid } from \"../src\"; // 性能测试助手 function measurePerformance( Component: React.ComponentType\u003cany\u003e, props: any, iterations: number = 100 ): Promise\u003c{ meanRenderTime: number; firstRender: number; reRenders: number[]; }\u003e { return new Promise((resolve) =\u003e { let firstRender: number | null = null; const reRenders: number[] = []; const handleRender: ProfilerOnRenderCallback = ( id, phase, actualDuration, baseDuration, startTime, commitTime ) =\u003e { if (firstRender === null) { firstRender = actualDuration; } else { reRenders.push(actualDuration); } if (reRenders.length \u003e= iterations - 1) { // 计算均值 const mean = reRenders.reduce((a, b) =\u003e a + b, firstRender!) / iterations; resolve({ meanRenderTime: mean, firstRender: firstRender!, reRenders, }); } }; // 使用Profiler测量组件性能 const { rerender } = render( \u003cProfiler id=\"performance-test\" onRender={handleRender}\u003e \u003cComponent {...props} /\u003e \u003c/Profiler\u003e ); // 进行多次重新渲染以获取更可靠的数据 for (let i = 0; i \u003c iterations; i++) { rerender( \u003cProfiler id=\"performance-test\" onRender={handleRender}\u003e \u003cComponent {...props} key={i} /\u003e \u003c/Profiler\u003e ); } }); } // 性能预算阈值 const PERFORMANCE_BUDGETS = { button: 5, // ms table: 50, // ms dataGrid: 100, // ms }; describe(\"Component Performance Tests\", () =\u003e { test(\"Button renders within performance budget\", async () =\u003e { const results = await measurePerformance(Button, { children: \"Performance Test\", variant: \"primary\", }); expect(results.meanRenderTime).toBeLessThan(PERFORMANCE_BUDGETS.button); }); test(\"Table renders within performance budget\", async () =\u003e { // 生成测试数据 const data = Array.from({ length: 100 }, (_, i) =\u003e ({ id: i, name: `Item ${i}`, value: Math.random() * 1000, })); const columns = [ { key: \"name\", title: \"Name\", dataIndex: \"name\" }, { key: \"value\", title: \"Value\", dataIndex: \"value\" }, ]; const results = await measurePerformance( Table, { data, columns }, 20 // 较少的迭代次数用于大型组件 ); expect(results.meanRenderTime).toBeLessThan(PERFORMANCE_BUDGETS.table); }); }); 项目实际数据与成果 我们的组件库通过严格的类型安全设计，取得了显著的成果：\n指标 改进前 改进后 改进率 组件使用错误率 每周约 85 个 每周约 6 个 93% 开发效率 每周平均 1.5 个组件 每周平均 2.5 个组件 67% 设计一致性 约 72% 约 98% 36% 组件复用率 约 35% 约 86% 146% 开发者满意度 61% 94% 54% 设计师满意度 58% 92% 59% 用户访问性评分 73/100 96/100 32% 代码量减少 - 约 63,000 行 - 产品开发周期 平均 8 周 平均 4.5 周 44% 最令人印象深刻的是，通过组件库的类型安全设计，我们的前端团队实现了：\n前端 bug 减少 87%：类型系统捕获了绝大多数常见错误 入职时间从 3 周降至 5 天：新开发者可以更快上手 客户满意度提升 26%：由于更一致的用户体验 结语 构建企业级 React 组件库是一项系统工程，需要在类型安全、性能、可访问性和开发体验之间取得平衡。我们的实践证明，以类型安全为第一公民的设计理念，能够显著提高组件库的质量和开发效率。\n通过精心设计的类型系统、严格的质量保证措施和以用户为中心的文档系统，组件库不仅提高了产品的开发效率，还改善了产品的用户体验和可维护性。类型驱动设计让我们能够在编译时捕获大部分错误，而不是在运行时或用户使用过程中才发现问题。\n在组件库设计过程中，我们发现几个关键因素对成功至关重要：\n类型优先设计：首先设计类型，然后实现组件 设计系统集成：将设计令牌转化为类型安全的代码 渐进式迁移：支持现有代码库的平滑过渡 持续质量保证：严格的自动化测试确保组件可靠性 优秀的开发体验：文档和 IDE 集成同样重要 未来，我们将探索更多前沿技术来增强组件库，包括自动类型生成、AI 辅助组件开发和更强大的设计系统集成。随着 TypeScript 和 React 的持续发展，组件库的可能性也在不断扩展。\n企业级组件库的构建是一次投资，它不仅提升了当前的开发效率，更为企业的长期技术演进奠定了基础。通过类型安全的组件库，我们能够更快地响应业务需求，同时保持卓越的产品质量和一致的用户体验。但是我们也应该意识到，避免重复造轮子。\n相关阅读 现代前端架构设计与性能优化 - 探索前端架构与性能的关系 深入浅出 Vite - 了解新一代构建工具的革命性突破 TypeScript 高级类型编程实战 - 学习 TypeScript 类型系统的高级应用 ","wordCount":"4434","inLanguage":"zh","image":"https://www.yss520.online/images/covers/react-component-library.jpg","datePublished":"2025-03-16T21:35:29+08:00","dateModified":"2025-03-16T21:35:29+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.yss520.online/zh/posts/react-component-library/"},"publisher":{"@type":"Organization","name":"Bruce的博客","logo":{"@type":"ImageObject","url":"https://www.yss520.online/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.yss520.online/zh/ accesskey=h title="Bruce的博客 (Alt + H)">Bruce的博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://www.yss520.online/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://www.yss520.online/zh/ title=首页><span>首页</span></a></li><li><a href=https://www.yss520.online/zh/posts/ title=博客><span>博客</span></a></li><li><a href=https://www.yss520.online/zh/tags/ title=标签><span>标签</span></a></li><li><a href=https://www.yss520.online/zh/categories/ title=分类><span>分类</span></a></li><li><a href=https://www.yss520.online/zh/projects/ title=项目><span>项目</span></a></li><li><a href=https://www.yss520.online/zh/gallery/ title=画廊><span>画廊</span></a></li><li><a href=https://www.yss520.online/zh/about/ title=关于><span>关于</span></a></li><li><a href=https://www.yss520.online/zh/contact/ title=联系><span>联系</span></a></li><li><a href=https://www.yss520.online/zh/search/ title="搜索 (Alt + /)" accesskey=/><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.yss520.online/zh/>主页</a>&nbsp;»&nbsp;<a href=https://www.yss520.online/zh/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">构建企业级 React 组件库：类型安全与设计系统的完美融合</h1><div class=post-description>从零开始构建一个支持多产品的企业级 React 组件库，通过严格的类型安全设计显著降低组件使用错误率，提升开发效率，实现产品设计一致性。</div><div class=post-meta><span title='2025-03-16 21:35:29 +0800 +0800'>三月 16, 2025</span>&nbsp;·&nbsp;21 分钟&nbsp;·&nbsp;4434 字</div></header><figure class=entry-cover><img loading=eager src=https://www.yss520.online/images/covers/react-component-library.jpg alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目录</span></summary><div class=inner><ul><li><a href=#%e4%bb%8e%e9%9b%b6%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7-react-%e7%bb%84%e4%bb%b6%e5%ba%93%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88 aria-label="从零构建企业级 React 组件库：类型安全与设计系统的完美融合">从零构建企业级 React 组件库：类型安全与设计系统的完美融合</a><ul><li><a href=#%e7%bb%84%e4%bb%b6%e5%ba%93%e5%8d%b1%e6%9c%ba%e4%b8%8d%e4%b8%80%e8%87%b4%e4%b8%8e%e7%b1%bb%e5%9e%8b%e6%b7%b7%e4%b9%b1 aria-label=组件库危机：不一致与类型混乱>组件库危机：不一致与类型混乱</a></li><li><a href=#%e7%bb%84%e4%bb%b6%e5%ba%93%e6%9e%b6%e6%9e%84%e4%bb%8e%e7%b1%bb%e5%9e%8b%e4%bc%98%e5%85%88%e5%88%b0%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f aria-label=组件库架构：从类型优先到设计系统>组件库架构：从类型优先到设计系统</a><ul><li><a href=#%e7%b1%bb%e5%9e%8b%e9%a9%b1%e5%8a%a8%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f aria-label=类型驱动设计模式>类型驱动设计模式</a></li><li><a href=#%e7%bb%84%e4%bb%b6%e5%86%85%e9%83%a8%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8 aria-label=组件内部类型安全>组件内部类型安全</a></li><li><a href=#%e8%ae%be%e8%ae%a1%e4%bb%a4%e7%89%8c%e7%b3%bb%e7%bb%9f aria-label=设计令牌系统>设计令牌系统</a></li><li><a href=#%e5%a4%8d%e5%90%88%e7%bb%84%e4%bb%b6%e6%a8%a1%e5%bc%8f%e7%9a%84%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8 aria-label=复合组件模式的类型安全>复合组件模式的类型安全</a></li><li><a href=#%e6%b3%9b%e5%9e%8b%e7%bb%84%e4%bb%b6%e8%ae%be%e8%ae%a1 aria-label=泛型组件设计>泛型组件设计</a></li></ul></li><li><a href=#%e6%9e%84%e5%bb%ba%e4%b8%8e%e5%8f%91%e5%b8%83%e7%ad%96%e7%95%a5 aria-label=构建与发布策略>构建与发布策略</a><ul><li><a href=#%e7%b1%bb%e5%9e%8b%e4%bc%98%e5%8c%96%e6%9e%84%e5%bb%ba%e9%85%8d%e7%bd%ae aria-label=类型优化构建配置>类型优化构建配置</a></li><li><a href=#%e6%89%93%e5%8c%85%e9%85%8d%e7%bd%ae aria-label=打包配置>打包配置</a></li><li><a href=#%e5%8c%85%e7%ae%a1%e7%90%86%e9%85%8d%e7%bd%ae aria-label=包管理配置>包管理配置</a></li></ul></li><li><a href=#%e7%b1%bb%e5%9e%8b%e6%b5%8b%e8%af%95%e4%b8%8e%e9%aa%8c%e8%af%81 aria-label=类型测试与验证>类型测试与验证</a></li><li><a href=#%e6%96%87%e6%a1%a3%e7%b3%bb%e7%bb%9f%e4%b8%8e%e5%bc%80%e5%8f%91%e4%bd%93%e9%aa%8c aria-label=文档系统与开发体验>文档系统与开发体验</a></li><li><a href=#%e7%bb%84%e4%bb%b6%e5%ba%93%e4%bd%bf%e7%94%a8%e4%b8%8e%e9%9b%86%e6%88%90 aria-label=组件库使用与集成>组件库使用与集成</a></li><li><a href=#%e7%bb%84%e4%bb%b6%e5%ba%93%e6%8c%81%e7%bb%ad%e6%bc%94%e8%bf%9b%e7%ad%96%e7%95%a5 aria-label=组件库持续演进策略>组件库持续演进策略</a><ul><li><a href=#%e7%89%88%e6%9c%ac%e6%8e%a7%e5%88%b6%e4%b8%8e%e5%90%91%e5%90%8e%e5%85%bc%e5%ae%b9 aria-label=版本控制与向后兼容>版本控制与向后兼容</a></li><li><a href=#%e8%bf%81%e7%a7%bb%e5%8a%a9%e6%89%8b%e4%b8%8e%e5%85%b1%e5%ad%98%e7%ad%96%e7%95%a5 aria-label=迁移助手与共存策略>迁移助手与共存策略</a></li></ul></li><li><a href=#%e8%b4%a8%e9%87%8f%e4%bf%9d%e8%af%81%e7%ad%96%e7%95%a5 aria-label=质量保证策略>质量保证策略</a><ul><li><a href=#%e5%8d%95%e5%85%83%e6%b5%8b%e8%af%95%e4%b8%8e%e9%9b%86%e6%88%90%e6%b5%8b%e8%af%95 aria-label=单元测试与集成测试>单元测试与集成测试</a></li><li><a href=#%e5%8f%af%e8%ae%bf%e9%97%ae%e6%80%a7%e6%b5%8b%e8%af%95 aria-label=可访问性测试>可访问性测试</a></li><li><a href=#%e6%80%a7%e8%83%bd%e6%b5%8b%e8%af%95 aria-label=性能测试>性能测试</a></li></ul></li><li><a href=#%e9%a1%b9%e7%9b%ae%e5%ae%9e%e9%99%85%e6%95%b0%e6%8d%ae%e4%b8%8e%e6%88%90%e6%9e%9c aria-label=项目实际数据与成果>项目实际数据与成果</a></li><li><a href=#%e7%bb%93%e8%af%ad aria-label=结语>结语</a></li><li><a href=#%e7%9b%b8%e5%85%b3%e9%98%85%e8%af%bb aria-label=相关阅读>相关阅读</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=从零构建企业级-react-组件库类型安全与设计系统的完美融合>从零构建企业级 React 组件库：类型安全与设计系统的完美融合<a hidden class=anchor aria-hidden=true href=#从零构建企业级-react-组件库类型安全与设计系统的完美融合>#</a></h1><p>在过去两年中，我负责为我们公司构建了一个包含超过 20 个组件的企业级 React 组件库。这个库现在支撑着我们 4 个不同的产品，拥有超过 10 万行代码的前端系统。通过严格的类型安全设计，我们将组件使用错误率降低了 93%，开发效率提升了 67%，产品设计一致性达到了前所未有的 98%。今天，我想分享构建类型安全组件库的完整旅程，从初始设计到生产部署的各个环节。</p><h2 id=组件库危机不一致与类型混乱>组件库危机：不一致与类型混乱<a hidden class=anchor aria-hidden=true href=#组件库危机不一致与类型混乱>#</a></h2><p>在决定构建自己的组件库之前，我们的产品线面临几个严重问题：</p><ol><li>不同团队重新发明相同组件，导致各产品视觉不一致</li><li>JavaScript 组件缺乏类型安全，频繁出现运行时错误</li><li>组件文档分散，新开发者上手缓慢</li><li>设计与开发割裂，需求变更导致大量返工</li></ol><p>这是一个经典的企业级前端困境：随着产品线扩展，开发效率和用户体验同时下降。</p><h2 id=组件库架构从类型优先到设计系统>组件库架构：从类型优先到设计系统<a hidden class=anchor aria-hidden=true href=#组件库架构从类型优先到设计系统>#</a></h2><p>我们首先确立了一个核心理念：类型安全是组件库的第一公民。</p><h3 id=类型驱动设计模式>类型驱动设计模式<a hidden class=anchor aria-hidden=true href=#类型驱动设计模式>#</a></h3><p>组件库最基本的组件开始于精确的类型定义：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// button.types.ts - 按钮组件类型基础
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 按钮尺寸枚举
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ButtonSize</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;small&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;medium&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;large&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 按钮变体枚举
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ButtonVariant</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;primary&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;secondary&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;tertiary&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;ghost&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;danger&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 按钮基础属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ButtonBaseProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 按钮尺寸 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>size?</span>: <span style=color:#66d9ef>ButtonSize</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 按钮变体样式 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>variant?</span>: <span style=color:#66d9ef>ButtonVariant</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 是否禁用 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 是否显示加载状态 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loading?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 左侧图标 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>leftIcon?</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 右侧图标 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rightIcon?</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 完全宽度（适应容器） */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fullWidth?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 圆形按钮（适用于仅含图标的情况） */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>isRound?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 自定义类名 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>className?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 链接按钮特有属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>LinkButtonProps</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ButtonBaseProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 链接目标 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>href</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 链接目标（同 a 标签的 target 属性） */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>target</span><span style=color:#f92672>?:</span> <span style=color:#e6db74>&#34;_blank&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;_self&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;_parent&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;_top&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 链接关系（同 a 标签的 rel 属性） */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rel?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 普通按钮特有属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>NormalButtonProps</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>ButtonBaseProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 按钮类型 */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>type</span><span style=color:#f92672>?:</span> <span style=color:#e6db74>&#34;button&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;reset&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 点击事件处理函数 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onClick?</span>: <span style=color:#66d9ef>React.MouseEventHandler</span>&lt;<span style=color:#f92672>HTMLButtonElement</span>&gt;;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 按钮组件属性联合类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ButtonProps</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> (<span style=color:#a6e22e>NormalButtonProps</span> <span style=color:#f92672>&amp;</span> { <span style=color:#a6e22e>href?</span>: <span style=color:#66d9ef>never</span> })
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> (<span style=color:#a6e22e>LinkButtonProps</span> <span style=color:#f92672>&amp;</span> { <span style=color:#66d9ef>type</span><span style=color:#f92672>?:</span> <span style=color:#66d9ef>never</span>; <span style=color:#a6e22e>onClick?</span>: <span style=color:#66d9ef>never</span> });
</span></span></code></pre></div><p>这种类型设计的好处是显而易见的：</p><ol><li><strong>文档即代码</strong>：类型注释直接形成 API 文档</li><li><strong>互斥属性处理</strong>：使用判别联合类型防止矛盾属性组合</li><li><strong>清晰的组件边界</strong>：开发者可以准确知道哪些属性可用</li></ol><h3 id=组件内部类型安全>组件内部类型安全<a hidden class=anchor aria-hidden=true href=#组件内部类型安全>#</a></h3><p>类型定义后，实现组件时依然保持严格的类型安全：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// Button.tsx - 类型安全的按钮组件实现
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ButtonProps</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;./button.types&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>classNames</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../utils&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Spinner</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../Spinner&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;./Button.css&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Button</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>ButtonProps</span>&gt; <span style=color:#f92672>=</span> (<span style=color:#a6e22e>props</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;medium&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>variant</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;primary&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>disabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>loading</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>leftIcon</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rightIcon</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>className</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>children</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fullWidth</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>isRound</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    ...<span style=color:#a6e22e>rest</span>
</span></span><span style=display:flex><span>  } <span style=color:#f92672>=</span> <span style=color:#a6e22e>props</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建组件类名
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>buttonClassNames</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>classNames</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;btn&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>`btn-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>variant</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>`btn-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;btn-disabled&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>disabled</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>loading</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;btn-loading&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>loading</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;btn-fullwidth&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>fullWidth</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;btn-round&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>isRound</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>className</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建共享属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sharedProps</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>className</span>: <span style=color:#66d9ef>buttonClassNames</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>disabled</span>: <span style=color:#66d9ef>disabled</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>loading</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;aria-disabled&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>disabled</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>loading</span>,
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理图标和加载状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>renderContent</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>    &lt;&gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>loading</span> <span style=color:#f92672>&amp;&amp;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Spinner</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>size</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;small&#34;</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;tiny&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;small&#34;</span>}
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn-spinner&#34;</span>
</span></span><span style=display:flex><span>        /&gt;
</span></span><span style=display:flex><span>      )}
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>leftIcon</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>loading</span> <span style=color:#f92672>&amp;&amp;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn-icon btn-icon-left&#34;</span>&gt;{<span style=color:#a6e22e>leftIcon</span>}&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>      )}
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn-text&#34;</span>&gt;{<span style=color:#a6e22e>children</span>}&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>rightIcon</span> <span style=color:#f92672>&amp;&amp;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn-icon btn-icon-right&#34;</span>&gt;{<span style=color:#a6e22e>rightIcon</span>}&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>      )}
</span></span><span style=display:flex><span>    &lt;/&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 根据是否有href属性决定渲染button还是a
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#e6db74>&#34;href&#34;</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>props</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>href</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>href</span>, <span style=color:#a6e22e>target</span>, <span style=color:#a6e22e>rel</span>, ...<span style=color:#a6e22e>linkRest</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>props</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>a</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>href</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>target</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rel</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>target</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;_blank&#34;</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;noopener noreferrer&#34;</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>rel</span>}
</span></span><span style=display:flex><span>        {<span style=color:#a6e22e>...sharedProps</span>}
</span></span><span style=display:flex><span>        {<span style=color:#a6e22e>...linkRest</span>}
</span></span><span style=display:flex><span>      &gt;
</span></span><span style=display:flex><span>        {<span style=color:#a6e22e>renderContent</span>()}
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>a</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;button&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onClick</span>,
</span></span><span style=display:flex><span>    ...<span style=color:#a6e22e>buttonRest</span>
</span></span><span style=display:flex><span>  } <span style=color:#f92672>=</span> <span style=color:#a6e22e>props</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>NormalButtonProps</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>type</span>} <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>onClick</span>} {<span style=color:#a6e22e>...sharedProps</span>} {<span style=color:#a6e22e>...buttonRest</span>}&gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>renderContent</span>()}
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>注意这里的类型安全实现：</p><ol><li>根据属性区分渲染<code>&lt;button></code>还是<code>&lt;a></code></li><li>使用类型断言确保正确的属性提取</li><li>保持事件处理器的类型安全</li></ol><h3 id=设计令牌系统>设计令牌系统<a hidden class=anchor aria-hidden=true href=#设计令牌系统>#</a></h3><p>企业级组件库的核心是设计令牌（Design Tokens）系统，它是组件和设计系统之间的桥梁：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// tokens/index.ts - 设计令牌体系
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ColorMode</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;light&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;dark&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ColorIntensity</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;50&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;100&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;200&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;300&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;400&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;500&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;600&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;700&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;800&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;900&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 颜色系统类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ColorSystem</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>primary</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>ColorIntensity</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>neutral</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>ColorIntensity</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>success</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>ColorIntensity</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>warning</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>ColorIntensity</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>error</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>ColorIntensity</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>info</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>ColorIntensity</span>, <span style=color:#a6e22e>string</span>&gt;;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 间距系统类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SpacingSystem</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>xs</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sm</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>md</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lg</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>xl</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;2xl&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;3xl&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 字体系统类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TypographySystem</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fontFamilies</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>heading</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>body</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>mono</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fontSizes</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xs</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sm</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>md</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lg</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xl</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;2xl&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;3xl&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;4xl&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fontWeights</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>normal</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>medium</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>semibold</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bold</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lineHeights</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tight</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>normal</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>relaxed</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 完整令牌系统
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>DesignTokens</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode</span>: <span style=color:#66d9ef>ColorMode</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span>: <span style=color:#66d9ef>ColorSystem</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>spacing</span>: <span style=color:#66d9ef>SpacingSystem</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>typography</span>: <span style=color:#66d9ef>TypographySystem</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shadows</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sm</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>md</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lg</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>radii</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sm</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>md</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lg</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>full</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>zIndices</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>base</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>dropdown</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sticky</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fixed</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>modal</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>popover</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>toast</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>transitions</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fast</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>normal</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>slow</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 默认浅色模式令牌
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lightTokens</span>: <span style=color:#66d9ef>DesignTokens</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;light&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colors</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>primary</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;50&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;#eef2ff&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;100&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;#e0e7ff&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#75715e>// ... 其他色阶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#e6db74>&#34;900&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;#312e81&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ... 其他颜色系列
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  },
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ... 其他令牌值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 深色模式令牌
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>darkTokens</span>: <span style=color:#66d9ef>DesignTokens</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colorMode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;dark&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ... 深色模式特定值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 类型安全的令牌访问函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>token</span><span style=color:#f92672>&lt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>K1</span> <span style=color:#66d9ef>extends</span> <span style=color:#66d9ef>keyof</span> <span style=color:#a6e22e>DesignTokens</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>K2</span> <span style=color:#66d9ef>extends</span> <span style=color:#66d9ef>keyof</span> <span style=color:#a6e22e>DesignTokens</span>[<span style=color:#a6e22e>K1</span>],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>K3</span> <span style=color:#66d9ef>extends</span> <span style=color:#66d9ef>keyof</span> <span style=color:#a6e22e>DesignTokens</span>[<span style=color:#a6e22e>K1</span>][<span style=color:#a6e22e>K2</span>]
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;</span>(<span style=color:#a6e22e>key1</span>: <span style=color:#66d9ef>K1</span>, <span style=color:#a6e22e>key2</span>: <span style=color:#66d9ef>K2</span>, <span style=color:#a6e22e>key3?</span>: <span style=color:#66d9ef>K3</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>string</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 实际实现会根据当前主题返回对应值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tokens</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>globalThemeState</span>.<span style=color:#a6e22e>isDark</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>darkTokens</span> : <span style=color:#66d9ef>lightTokens</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>key3</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>tokens</span>[<span style=color:#a6e22e>key1</span>][<span style=color:#a6e22e>key2</span>][<span style=color:#a6e22e>key3</span>] <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>tokens</span>[<span style=color:#a6e22e>key1</span>][<span style=color:#a6e22e>key2</span>] <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>这种设计令牌系统的优势：</p><ol><li><strong>类型安全访问</strong>：无法访问不存在的令牌</li><li><strong>主题切换支持</strong>：支持动态切换明暗模式</li><li><strong>中心化管理</strong>：设计变更只需修改令牌值</li></ol><h3 id=复合组件模式的类型安全>复合组件模式的类型安全<a hidden class=anchor aria-hidden=true href=#复合组件模式的类型安全>#</a></h3><p>对于复杂组件，我们采用复合组件模式，同时保持类型安全：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// Select/index.tsx - 类型安全的复合组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span>, { <span style=color:#a6e22e>createContext</span>, <span style=color:#a6e22e>useContext</span>, <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 基本类型定义
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SelectOption</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SelectContextValue</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectedValue</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onChange</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>isOpen</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>setIsOpen</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>isOpen</span>: <span style=color:#66d9ef>boolean</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>options</span>: <span style=color:#66d9ef>SelectOption</span>[];
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 创建上下文
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>SelectContext</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createContext</span>&lt;<span style=color:#f92672>SelectContextValue</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>undefined</span>&gt;(<span style=color:#66d9ef>undefined</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 子组件属性类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SelectTriggerProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>placeholder?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children?</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SelectOptionProps</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>SelectOption</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children?</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>SelectProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>defaultValue?</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onChange</span><span style=color:#f92672>?:</span> (<span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>options</span>: <span style=color:#66d9ef>SelectOption</span>[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 主组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Select</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>SelectProps</span>&gt; <span style=color:#f92672>&amp;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Trigger</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>SelectTriggerProps</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Options</span>: <span style=color:#66d9ef>React.FC</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Option</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>SelectOptionProps</span>&gt;;
</span></span><span style=display:flex><span>} <span style=color:#f92672>=</span> ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>controlledValue</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>defaultValue</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onChange</span>: <span style=color:#66d9ef>onChangeProp</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>options</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span>,
</span></span><span style=display:flex><span>}) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理受控/非受控状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>internalValue</span>, <span style=color:#a6e22e>setInternalValue</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>&lt;<span style=color:#f92672>string</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>undefined</span>&gt;(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>defaultValue</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>isOpen</span>, <span style=color:#a6e22e>setIsOpen</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 判断是受控还是非受控组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isControlled</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>controlledValue</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>undefined</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>selectedValue</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>isControlled</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>controlledValue</span> : <span style=color:#66d9ef>internalValue</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理值变更
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>onChange</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isControlled</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>setInternalValue</span>(<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onChangeProp</span><span style=color:#f92672>?</span>.(<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setIsOpen</span>(<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 提供上下文
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>SelectContext.Provider</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>selectedValue</span>, <span style=color:#a6e22e>onChange</span>, <span style=color:#a6e22e>isOpen</span>, <span style=color:#a6e22e>setIsOpen</span>, <span style=color:#a6e22e>options</span> }}
</span></span><span style=display:flex><span>    &gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;select-container&#34;</span>&gt;{<span style=color:#a6e22e>children</span>}&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>SelectContext.Provider</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用上下文的自定义钩子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>useSelectContext</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>context</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useContext</span>(<span style=color:#a6e22e>SelectContext</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>context</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;Select compound components must be used within a Select component&#34;</span>
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>context</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 触发器组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>SelectTrigger</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>SelectTriggerProps</span>&gt; <span style=color:#f92672>=</span> ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>placeholder</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Select option&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span>,
</span></span><span style=display:flex><span>}) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>selectedValue</span>, <span style=color:#a6e22e>isOpen</span>, <span style=color:#a6e22e>setIsOpen</span>, <span style=color:#a6e22e>options</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useSelectContext</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 查找选中项的标签
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>selectedOption</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>find</span>((<span style=color:#a6e22e>opt</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>opt</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>selectedValue</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>displayText</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>selectedOption</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>label</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>placeholder</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>button</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;button&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#e6db74>`select-trigger </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>isOpen</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;open&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>disabled</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>setIsOpen</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>isOpen</span>)}
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>disabled</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>disabled</span>}
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>aria-haspopup</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;listbox&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>aria-expanded</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>isOpen</span>}
</span></span><span style=display:flex><span>    &gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>children</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>displayText</span>}
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;select-arrow&#34;</span>&gt;<span style=color:#960050;background-color:#1e0010>▼</span>&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 选项列表容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>SelectOptions</span>: <span style=color:#66d9ef>React.FC</span> <span style=color:#f92672>=</span> ({ <span style=color:#a6e22e>children</span> }) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>isOpen</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useSelectContext</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isOpen</span>) <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>ul</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;select-options&#34;</span> <span style=color:#a6e22e>role</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;listbox&#34;</span>&gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>children</span>}
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>ul</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 单个选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>SelectOption</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>SelectOptionProps</span>&gt; <span style=color:#f92672>=</span> ({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>label</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span>,
</span></span><span style=display:flex><span>}) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>selectedValue</span>, <span style=color:#a6e22e>onChange</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useSelectContext</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isSelected</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>selectedValue</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>li</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#e6db74>`select-option </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>isSelected</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;selected&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>disabled</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;disabled&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>role</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;option&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>aria-selected</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>isSelected</span>}
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>aria-disabled</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>disabled</span>}
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>disabled</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>onChange</span>(<span style=color:#a6e22e>value</span>)}
</span></span><span style=display:flex><span>    &gt;
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>children</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>label</span>}
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>isSelected</span> <span style=color:#f92672>&amp;&amp;</span> &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;select-check&#34;</span>&gt;<span style=color:#960050;background-color:#1e0010>✓</span>&lt;/<span style=color:#f92672>span</span>&gt;}
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>li</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 组装复合组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Select</span>.<span style=color:#a6e22e>Trigger</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>SelectTrigger</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>Select</span>.<span style=color:#a6e22e>Options</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>SelectOptions</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>Select</span>.<span style=color:#a6e22e>Option</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>SelectOption</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> { <span style=color:#a6e22e>Select</span> };
</span></span></code></pre></div><p>复合组件的类型安全优势：</p><ol><li><strong>子组件类型检查</strong>：每个子组件有自己的类型定义</li><li><strong>上下文类型安全</strong>：通过钩子提供类型安全的上下文访问</li><li><strong>组合清晰</strong>：用户可以清楚地了解组件结构</li></ol><h3 id=泛型组件设计>泛型组件设计<a hidden class=anchor aria-hidden=true href=#泛型组件设计>#</a></h3><p>泛型组件是构建高度可复用组件的关键：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// Table.tsx - 泛型表格组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Column</span>&lt;<span style=color:#f92672>T</span>&gt; {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>key</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dataIndex?</span>: <span style=color:#66d9ef>keyof</span> <span style=color:#a6e22e>T</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>render</span><span style=color:#f92672>?:</span> (<span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>any</span>, <span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>T</span>, <span style=color:#a6e22e>index</span>: <span style=color:#66d9ef>number</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>ReactNode</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>width?</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sortable?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>sortFn</span><span style=color:#f92672>?:</span> (<span style=color:#a6e22e>a</span>: <span style=color:#66d9ef>T</span>, <span style=color:#a6e22e>b</span>: <span style=color:#66d9ef>T</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filterable?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filterOptions</span><span style=color:#f92672>?:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>label</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  }[];
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filterFn</span><span style=color:#f92672>?:</span> (<span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>T</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>TableProps</span>&lt;<span style=color:#f92672>T</span>&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 数据源 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>T</span>[];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 列定义 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>columns</span>: <span style=color:#66d9ef>Column</span>&lt;<span style=color:#f92672>T</span>&gt;[];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 是否显示加载状态 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loading?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 是否具有边框 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>bordered?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 是否可选择行 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectable?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 选中的行key列表 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selectedRowKeys?</span>: <span style=color:#66d9ef>React.Key</span>[];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 选择变化回调 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onSelectChange</span><span style=color:#f92672>?:</span> (<span style=color:#a6e22e>selectedRowKeys</span>: <span style=color:#66d9ef>React.Key</span>[], <span style=color:#a6e22e>selectedRows</span>: <span style=color:#66d9ef>T</span>[]) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 行键获取函数 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rowKey?</span>: <span style=color:#66d9ef>keyof</span> <span style=color:#a6e22e>T</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>T</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>Key</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 自定义空状态内容 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>emptyContent?</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 表格尺寸 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>size</span><span style=color:#f92672>?:</span> <span style=color:#e6db74>&#34;small&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;medium&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;large&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 自定义行类名 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rowClassName?</span>: <span style=color:#66d9ef>string</span> <span style=color:#f92672>|</span> ((<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>T</span>, <span style=color:#a6e22e>index</span>: <span style=color:#66d9ef>number</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>string</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 固定表头 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stickyHeader?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 表格高度 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>height?</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 每页显示条数 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pageSize?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 当前页码 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>currentPage?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 总条数 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>total?</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/** 分页变化回调 */</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onPaginationChange</span><span style=color:#f92672>?:</span> (<span style=color:#a6e22e>page</span>: <span style=color:#66d9ef>number</span>, <span style=color:#a6e22e>pageSize</span>: <span style=color:#66d9ef>number</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Table</span>&lt;<span style=color:#f92672>T</span> <span style=color:#a6e22e>extends</span> <span style=color:#a6e22e>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>any</span>&gt;&gt;(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>TableProps</span>&lt;<span style=color:#f92672>T</span>&gt;
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>ReactElement</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>columns</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>loading</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bordered</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selectable</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>selectedRowKeys</span> <span style=color:#f92672>=</span> [],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onSelectChange</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rowKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;id&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>emptyContent</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;medium&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rowClassName</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>stickyHeader</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pageSize</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>currentPage</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>total</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onPaginationChange</span>,
</span></span><span style=display:flex><span>  } <span style=color:#f92672>=</span> <span style=color:#a6e22e>props</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 获取行键
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>getRowKey</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>T</span>, <span style=color:#a6e22e>index</span>: <span style=color:#66d9ef>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>Key</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>rowKey</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;function&#34;</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>rowKey</span>(<span style=color:#a6e22e>record</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>record</span>[<span style=color:#a6e22e>rowKey</span>] <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>unknown</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>Key</span>;
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 渲染表头
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>renderHeader</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>thead</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-header&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>        {<span style=color:#a6e22e>selectable</span> <span style=color:#f92672>&amp;&amp;</span> (
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>th</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-selection-column&#34;</span>&gt;
</span></span><span style=display:flex><span>            {<span style=color:#75715e>/* 全选checkbox实现 */</span>}
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>input</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;checkbox&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>checked</span><span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>selectedRowKeys</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>length</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleSelectAll</span>}
</span></span><span style=display:flex><span>            /&gt;
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>th</span>&gt;
</span></span><span style=display:flex><span>        )}
</span></span><span style=display:flex><span>        {<span style=color:#a6e22e>columns</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>column</span>, <span style=color:#a6e22e>index</span>) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>th</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>key</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>index</span>}
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>width</span>: <span style=color:#66d9ef>column.width</span> }}
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>sortable</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;sortable-column&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span>}
</span></span><span style=display:flex><span>          &gt;
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>title</span>}
</span></span><span style=display:flex><span>            {<span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>sortable</span> <span style=color:#f92672>&amp;&amp;</span> (
</span></span><span style=display:flex><span>              &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sort-icons&#34;</span>&gt;{<span style=color:#75715e>/* 排序图标 */</span>}&lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>            )}
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>th</span>&gt;
</span></span><span style=display:flex><span>        ))}
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>thead</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理全选
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleSelectAll</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>: <span style=color:#66d9ef>React.ChangeEvent</span>&lt;<span style=color:#f92672>HTMLInputElement</span>&gt;) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>onSelectChange</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>checked</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>allKeys</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>index</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>getRowKey</span>(<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>index</span>));
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>onSelectChange</span>(<span style=color:#a6e22e>allKeys</span>, [...<span style=color:#a6e22e>data</span>]);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>onSelectChange</span>([], []);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理行选择
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleSelect</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>record</span>: <span style=color:#66d9ef>T</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>index</span>: <span style=color:#66d9ef>number</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>e</span>: <span style=color:#66d9ef>React.ChangeEvent</span>&lt;<span style=color:#f92672>HTMLInputElement</span>&gt;
</span></span><span style=display:flex><span>  ) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>onSelectChange</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getRowKey</span>(<span style=color:#a6e22e>record</span>, <span style=color:#a6e22e>index</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newSelectedRowKeys</span> <span style=color:#f92672>=</span> [...<span style=color:#a6e22e>selectedRowKeys</span>];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newSelectedRows</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      ...<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>i</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>selectedRowKeys</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>getRowKey</span>(<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>i</span>))),
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>checked</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>newSelectedRowKeys</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>key</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>newSelectedRows</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>record</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>newSelectedRowKeys</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newSelectedRowKeys</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>k</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>k</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>key</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>newSelectedRows</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newSelectedRows</span>.<span style=color:#a6e22e>filter</span>(
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>i</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>getRowKey</span>(<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>i</span>) <span style=color:#f92672>!==</span> <span style=color:#a6e22e>key</span>
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onSelectChange</span>(<span style=color:#a6e22e>newSelectedRowKeys</span>, <span style=color:#a6e22e>newSelectedRows</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 渲染表体
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>renderBody</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>loading</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>tbody</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>td</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>colSpan</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>selectable</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>columns</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>1</span> : <span style=color:#66d9ef>columns.length</span>}
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-loading-cell&#34;</span>
</span></span><span style=display:flex><span>            &gt;
</span></span><span style=display:flex><span>              {<span style=color:#75715e>/* 加载指示器 */</span>}
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Loading</span>...
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>td</span>&gt;
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>tbody</span>&gt;
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>tbody</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>td</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>colSpan</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>selectable</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>columns</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>1</span> : <span style=color:#66d9ef>columns.length</span>}
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-empty-cell&#34;</span>
</span></span><span style=display:flex><span>            &gt;
</span></span><span style=display:flex><span>              {<span style=color:#a6e22e>emptyContent</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;No data&#34;</span>}
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>td</span>&gt;
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>tbody</span>&gt;
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>tbody</span>&gt;
</span></span><span style=display:flex><span>        {<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>record</span>, <span style=color:#a6e22e>rowIndex</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getRowKey</span>(<span style=color:#a6e22e>record</span>, <span style=color:#a6e22e>rowIndex</span>);
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isSelected</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>selectedRowKeys</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>key</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>tr</span>
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>key</span>}
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>rowClassName</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;function&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>?</span> <span style=color:#a6e22e>rowClassName</span>(<span style=color:#a6e22e>record</span>, <span style=color:#a6e22e>rowIndex</span>)
</span></span><span style=display:flex><span>                  <span style=color:#f92672>:</span> <span style=color:#a6e22e>rowClassName</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>data-selected</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>isSelected</span>}
</span></span><span style=display:flex><span>            &gt;
</span></span><span style=display:flex><span>              {<span style=color:#a6e22e>selectable</span> <span style=color:#f92672>&amp;&amp;</span> (
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>td</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-selection-column&#34;</span>&gt;
</span></span><span style=display:flex><span>                  &lt;<span style=color:#f92672>input</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;checkbox&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>checked</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>isSelected</span>}
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{(<span style=color:#a6e22e>e</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>handleSelect</span>(<span style=color:#a6e22e>record</span>, <span style=color:#a6e22e>rowIndex</span>, <span style=color:#a6e22e>e</span>)}
</span></span><span style=display:flex><span>                  /&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>td</span>&gt;
</span></span><span style=display:flex><span>              )}
</span></span><span style=display:flex><span>              {<span style=color:#a6e22e>columns</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>column</span>, <span style=color:#a6e22e>colIndex</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cellValue</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>dataIndex</span>
</span></span><span style=display:flex><span>                  <span style=color:#f92672>?</span> <span style=color:#a6e22e>record</span>[<span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>dataIndex</span>]
</span></span><span style=display:flex><span>                  <span style=color:#f92672>:</span> <span style=color:#66d9ef>undefined</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>                  &lt;<span style=color:#f92672>td</span> <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>key</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>colIndex</span>}&gt;
</span></span><span style=display:flex><span>                    {<span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>render</span>
</span></span><span style=display:flex><span>                      <span style=color:#f92672>?</span> <span style=color:#a6e22e>column</span>.<span style=color:#a6e22e>render</span>(<span style=color:#a6e22e>cellValue</span>, <span style=color:#a6e22e>record</span>, <span style=color:#a6e22e>rowIndex</span>)
</span></span><span style=display:flex><span>                      <span style=color:#f92672>:</span> <span style=color:#a6e22e>cellValue</span>}
</span></span><span style=display:flex><span>                  &lt;/<span style=color:#f92672>td</span>&gt;
</span></span><span style=display:flex><span>                );
</span></span><span style=display:flex><span>              })}
</span></span><span style=display:flex><span>            &lt;/<span style=color:#f92672>tr</span>&gt;
</span></span><span style=display:flex><span>          );
</span></span><span style=display:flex><span>        })}
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>tbody</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#e6db74>`table-container size-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>size</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>bordered</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;bordered&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}
</span></span><span style=display:flex><span>    &gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#e6db74>`table-content </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>stickyHeader</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;sticky-header&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>height</span> <span style=color:#f92672>?</span> { <span style=color:#a6e22e>height</span> } <span style=color:#f92672>:</span> <span style=color:#66d9ef>undefined</span>}
</span></span><span style=display:flex><span>      &gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>table</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table&#34;</span>&gt;
</span></span><span style=display:flex><span>          {<span style=color:#a6e22e>renderHeader</span>()}
</span></span><span style=display:flex><span>          {<span style=color:#a6e22e>renderBody</span>()}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>table</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      {<span style=color:#75715e>/* 分页组件 */</span>}
</span></span><span style=display:flex><span>      {<span style=color:#a6e22e>pageSize</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>total</span> <span style=color:#f92672>&amp;&amp;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-pagination&#34;</span>&gt;{<span style=color:#75715e>/* 分页实现 */</span>}&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      )}
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>泛型组件类型安全的优势：</p><ol><li><strong>数据类型保留</strong>：表格保持数据源的原始类型</li><li><strong>列定义类型安全</strong>：列定义自动绑定到数据类型</li><li><strong>回调类型安全</strong>：事件处理器接收正确的参数类型</li><li><strong>条件渲染类型安全</strong>：根据属性条件渲染时保持类型安全</li></ol><h2 id=构建与发布策略>构建与发布策略<a hidden class=anchor aria-hidden=true href=#构建与发布策略>#</a></h2><p>组件库构建和发布是一个常被忽视但至关重要的环节。</p><h3 id=类型优化构建配置>类型优化构建配置<a hidden class=anchor aria-hidden=true href=#类型优化构建配置>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// tsconfig.json - 组件库类型构建配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;compilerOptions&#34;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;target&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;es2019&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;module&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;esnext&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;lib&#34;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;dom&#34;</span>, <span style=color:#e6db74>&#34;dom.iterable&#34;</span>, <span style=color:#e6db74>&#34;esnext&#34;</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;declaration&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;declarationDir&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;dist/types&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sourceMap&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;jsx&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;react&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;strict&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;noImplicitAny&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;strictNullChecks&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;strictFunctionTypes&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;strictBindCallApply&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;strictPropertyInitialization&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;noImplicitThis&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;alwaysStrict&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;noUnusedLocals&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;noUnusedParameters&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;noImplicitReturns&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;noFallthroughCasesInSwitch&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;moduleResolution&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;node&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;allowSyntheticDefaultImports&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;esModuleInterop&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;skipLibCheck&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;forceConsistentCasingInFileNames&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;resolveJsonModule&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;include&#34;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;src&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;exclude&#34;</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;node_modules&#34;</span>, <span style=color:#e6db74>&#34;dist&#34;</span>, <span style=color:#e6db74>&#34;**/*.test.ts&#34;</span>, <span style=color:#e6db74>&#34;**/*.test.tsx&#34;</span>]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>这个配置确保：</p><ol><li>生成高质量的类型声明文件</li><li>严格的类型检查</li><li>排除测试文件和生成的文件</li></ol><h3 id=打包配置>打包配置<a hidden class=anchor aria-hidden=true href=#打包配置>#</a></h3><p>我们使用 Rollup 进行库打包，支持多种模块格式：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// rollup.config.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>resolve</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;@rollup/plugin-node-resolve&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>commonjs</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;@rollup/plugin-commonjs&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>typescript</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;@rollup/plugin-typescript&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>terser</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;rollup-plugin-terser&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>peerDepsExternal</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;rollup-plugin-peer-deps-external&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>postcss</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;rollup-plugin-postcss&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>autoprefixer</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;autoprefixer&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>cssnano</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;cssnano&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>dts</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;rollup-plugin-dts&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>packageJson</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;./package.json&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 共享插件配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>plugins</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>peerDepsExternal</span>(),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resolve</span>(),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>commonjs</span>(),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>typescript</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tsconfig</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;./tsconfig.json&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>exclude</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;**/*.test.ts&#34;</span>, <span style=color:#e6db74>&#34;**/*.test.tsx&#34;</span>],
</span></span><span style=display:flex><span>  }),
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>postcss</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>autoprefixer</span>(), <span style=color:#a6e22e>cssnano</span>()],
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>extract</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;styles.css&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>modules</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>autoModules</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sourceMap</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>minimize</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  }),
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> [
</span></span><span style=display:flex><span>  <span style=color:#75715e>// CommonJS 构建
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>input</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;src/index.ts&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>file</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>packageJson</span>.<span style=color:#a6e22e>main</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>format</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;cjs&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sourcemap</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>plugins</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ES 模块构建
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>input</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;src/index.ts&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>file</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>packageJson</span>.<span style=color:#a6e22e>module</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>format</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;esm&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sourcemap</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>plugins</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#75715e>// UMD 构建 (压缩)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>input</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;src/index.ts&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>file</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>packageJson</span>.<span style=color:#a6e22e>unpkg</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>format</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;umd&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;MyUILib&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>sourcemap</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>globals</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>react</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;React&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;react-dom&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ReactDOM&#34;</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [...<span style=color:#a6e22e>plugins</span>, <span style=color:#a6e22e>terser</span>()],
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 类型声明文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>input</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;dist/types/index.d.ts&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>output</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>file</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;dist/index.d.ts&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>format</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;es&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>dts</span>()],
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>];
</span></span></code></pre></div><p>这种配置带来的优势：</p><ol><li><strong>多种模块格式</strong>：支持 CJS, ESM 和 UMD</li><li><strong>类型声明整合</strong>：将分散的类型文件整合为单一入口</li><li><strong>CSS 提取与优化</strong>：提取和优化 CSS</li></ol><h3 id=包管理配置>包管理配置<a hidden class=anchor aria-hidden=true href=#包管理配置>#</a></h3><p><code>package.json</code>的正确配置对类型安全至关重要：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;my-ui-library&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;1.0.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Enterprise-grade React component library with type safety&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;main&#34;</span>: <span style=color:#e6db74>&#34;dist/index.cjs.js&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;module&#34;</span>: <span style=color:#e6db74>&#34;dist/index.esm.js&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;unpkg&#34;</span>: <span style=color:#e6db74>&#34;dist/index.umd.js&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;types&#34;</span>: <span style=color:#e6db74>&#34;dist/index.d.ts&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;sideEffects&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;files&#34;</span>: [<span style=color:#e6db74>&#34;dist&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scripts&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build&#34;</span>: <span style=color:#e6db74>&#34;rollup -c&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;dev&#34;</span>: <span style=color:#e6db74>&#34;rollup -c -w&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;test&#34;</span>: <span style=color:#e6db74>&#34;jest&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;lint&#34;</span>: <span style=color:#e6db74>&#34;eslint src --ext .ts,.tsx&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;typecheck&#34;</span>: <span style=color:#e6db74>&#34;tsc --noEmit&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;storybook&#34;</span>: <span style=color:#e6db74>&#34;start-storybook -p 6006&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build-storybook&#34;</span>: <span style=color:#e6db74>&#34;build-storybook&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;prepublishOnly&#34;</span>: <span style=color:#e6db74>&#34;npm run typecheck &amp;&amp; npm run test &amp;&amp; npm run build&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;peerDependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;react&#34;</span>: <span style=color:#e6db74>&#34;&gt;=16.8.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;react-dom&#34;</span>: <span style=color:#e6db74>&#34;&gt;=16.8.0&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;exports&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;.&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;import&#34;</span>: <span style=color:#e6db74>&#34;./dist/index.esm.js&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;require&#34;</span>: <span style=color:#e6db74>&#34;./dist/index.cjs.js&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;default&#34;</span>: <span style=color:#e6db74>&#34;./dist/index.cjs.js&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;./styles.css&#34;</span>: <span style=color:#e6db74>&#34;./dist/styles.css&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;typesVersions&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;*&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;*&#34;</span>: [<span style=color:#e6db74>&#34;./dist/index.d.ts&#34;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>注意这里的关键点：</p><ol><li><strong>条件导出</strong>：支持基于导入方式选择正确的格式</li><li><strong>类型版本</strong>：确保类型被正确解析</li><li><strong>副作用标记</strong>：支持 tree-shaking 优化</li></ol><h2 id=类型测试与验证>类型测试与验证<a hidden class=anchor aria-hidden=true href=#类型测试与验证>#</a></h2><p>组件库的类型测试至关重要，确保类型定义是正确的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// Button.typetest.ts - 类型测试
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>expectType</span>, <span style=color:#a6e22e>expectError</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;tsd&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Button</span>, <span style=color:#a6e22e>ButtonProps</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../src&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 测试基本用法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectType</span>&lt;<span style=color:#f92672>JSX.Element</span>&gt;(&lt;<span style=color:#f92672>Button</span>&gt;<span style=color:#a6e22e>Click</span> <span style=color:#a6e22e>Me</span>&lt;/<span style=color:#f92672>Button</span>&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 测试属性推断
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectType</span>&lt;<span style=color:#f92672>JSX.Element</span>&gt;(
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>Button</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;primary&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;medium&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>disabled</span><span style=color:#f92672>=</span>{<span style=color:#66d9ef>true</span>}
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>leftIcon</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>span</span>&gt;<span style=color:#a6e22e>icon</span>&lt;/<span style=color:#f92672>span</span>&gt;}
</span></span><span style=display:flex><span>  &gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Click</span> <span style=color:#a6e22e>Me</span>
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 测试链接按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectType</span>&lt;<span style=color:#f92672>JSX.Element</span>&gt;(
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://example.com&#34;</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span>&gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Link</span> <span style=color:#a6e22e>Button</span>
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 测试类型限制 - 禁止同时使用href和onClick
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectError</span>(
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://example.com&#34;</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> {}}&gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Invalid</span>
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 测试类型限制 - 变体必须是有效值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectError</span>(&lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;invalidVariant&#34;</span>&gt;<span style=color:#a6e22e>Invalid</span>&lt;/<span style=color:#f92672>Button</span>&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 测试类型限制 - 尺寸必须是有效值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectError</span>(&lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;invalidSize&#34;</span>&gt;<span style=color:#a6e22e>Invalid</span>&lt;/<span style=color:#f92672>Button</span>&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 测试泛型组件类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Table</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../src&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>email</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>active</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 正确的列定义
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectType</span>&lt;<span style=color:#f92672>JSX.Element</span>&gt;(
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>Table</span>&lt;<span style=color:#f92672>User</span>&gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>=</span>{[{ <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>1</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#a6e22e>email</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;john@example.com&#34;</span>, <span style=color:#a6e22e>active</span>: <span style=color:#66d9ef>true</span> }]}
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>columns</span><span style=color:#f92672>=</span>{[
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Name&#34;</span>, <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;name&#34;</span> },
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;email&#34;</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Email&#34;</span>, <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;email&#34;</span> },
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;actions&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Actions&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>render</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>record</span>) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>          <span style=color:#75715e>// record被正确推断为User类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>record</span>.<span style=color:#a6e22e>id</span>)}&gt;<span style=color:#a6e22e>View</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>        ),
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    ]}
</span></span><span style=display:flex><span>  /&gt;
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 列与数据不匹配时
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>expectError</span>(
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>Table</span>&lt;<span style=color:#f92672>User</span>&gt;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span><span style=color:#f92672>=</span>{[{ <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>1</span>, <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#a6e22e>email</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;john@example.com&#34;</span>, <span style=color:#a6e22e>active</span>: <span style=color:#66d9ef>true</span> }]}
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>columns</span><span style=color:#f92672>=</span>{[
</span></span><span style=display:flex><span>      <span style=color:#75715e>// `username`不存在于User类型上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      { <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;username&#34;</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Username&#34;</span>, <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;username&#34;</span> },
</span></span><span style=display:flex><span>    ]}
</span></span><span style=display:flex><span>  /&gt;
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>这种类型测试确保：</p><ol><li>组件接受正确的属性</li><li>必填属性不能省略</li><li>互斥属性不能同时使用</li><li>泛型组件保持正确的类型推断</li></ol><h2 id=文档系统与开发体验>文档系统与开发体验<a hidden class=anchor aria-hidden=true href=#文档系统与开发体验>#</a></h2><p>使用 Storybook 构建类型感知的文档系统：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// Button.stories.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Meta</span>, <span style=color:#a6e22e>Story</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@storybook/react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Button</span>, <span style=color:#a6e22e>ButtonProps</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../src&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 元数据类型提供文档信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Components/Button&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>component</span>: <span style=color:#66d9ef>Button</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>argTypes</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>variant</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;select&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;primary&#34;</span>, <span style=color:#e6db74>&#34;secondary&#34;</span>, <span style=color:#e6db74>&#34;tertiary&#34;</span>, <span style=color:#e6db74>&#34;ghost&#34;</span>, <span style=color:#e6db74>&#34;danger&#34;</span>],
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Button style variant&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;primary&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;string&#34;</span> },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;primary&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;radio&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;small&#34;</span>, <span style=color:#e6db74>&#34;medium&#34;</span>, <span style=color:#e6db74>&#34;large&#34;</span>],
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Button size&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;medium&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;string&#34;</span> },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;medium&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>disabled</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;boolean&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Whether the button is disabled&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>defaultValue</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;boolean&#34;</span> },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span>: <span style=color:#66d9ef>false</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>loading</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;boolean&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Whether to show loading state&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>defaultValue</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;boolean&#34;</span> },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span>: <span style=color:#66d9ef>false</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>leftIcon</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> { <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text&#34;</span> },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Icon component to display at the left side&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ReactNode&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rightIcon</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> { <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text&#34;</span> },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Icon component to display at the right side&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ReactNode&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fullWidth</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;boolean&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Whether the button should take full width of container&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>defaultValue</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;boolean&#34;</span> },
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span>: <span style=color:#66d9ef>false</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Button content&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>defaultValue</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Button&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ReactNode&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>href</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;URL to navigate to (turns button into an anchor link)&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;string&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>control</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;select&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;_blank&#34;</span>, <span style=color:#e6db74>&#34;_self&#34;</span>, <span style=color:#e6db74>&#34;_parent&#34;</span>, <span style=color:#e6db74>&#34;_top&#34;</span>],
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Where to open the linked URL&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;string&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>onClick</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;clicked&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Click event handler&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>table</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;function&#34;</span> },
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>Meta</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 创建类型安全的模板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Template</span>: <span style=color:#66d9ef>Story</span>&lt;<span style=color:#f92672>ButtonProps</span>&gt; <span style=color:#f92672>=</span> (<span style=color:#a6e22e>args</span>) <span style=color:#f92672>=&gt;</span> &lt;<span style=color:#f92672>Button</span> {<span style=color:#a6e22e>...args</span>} /&gt;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导出基本变体
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Primary</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>Primary</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>variant</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;primary&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Primary Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Secondary</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>Secondary</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>variant</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;secondary&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Secondary Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Danger</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>Danger</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>variant</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;danger&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Danger Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导出尺寸变体
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Small</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>Small</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;small&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Small Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Large</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>Large</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;large&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Large Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导出状态变体
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Disabled</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>Disabled</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Disabled Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Loading</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>Loading</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>loading</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Loading Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导出链接按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>LinkButton</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>LinkButton</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>href</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;https://example.com&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;_blank&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Link Button&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 组合使用示例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>WithIcons</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Template</span>.<span style=color:#a6e22e>bind</span>({});
</span></span><span style=display:flex><span><span style=color:#a6e22e>WithIcons</span>.<span style=color:#a6e22e>args</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>leftIcon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;👈&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>rightIcon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;👉&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Button with Icons&#34;</span>,
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>我们的 Storybook 配置添加了 TypeScript 支持：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// .storybook/main.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stories</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#34;../stories/**/*.stories.@(ts|tsx|js|jsx)&#34;</span>],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>addons</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;@storybook/addon-links&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;@storybook/addon-essentials&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;@storybook/addon-a11y&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;@storybook/addon-interactions&#34;</span>,
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>framework</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;@storybook/react&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>typescript</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>check</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>checkOptions</span><span style=color:#f92672>:</span> {},
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>reactDocgen</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;react-docgen-typescript&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>reactDocgenTypescriptOptions</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>shouldExtractLiteralValuesFromEnum</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>propFilter</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>prop</span>) =&gt;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>parent</span> <span style=color:#f92672>?</span> <span style=color:#f92672>!</span><span style=color:#e6db74>/node_modules/</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>prop</span>.<span style=color:#a6e22e>parent</span>.<span style=color:#a6e22e>fileName</span>) <span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>compilerOptions</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>allowSyntheticDefaultImports</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>esModuleInterop</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>这种文档系统的优势：</p><ol><li><strong>类型自动推导</strong>：组件类型自动转换为控件</li><li><strong>智能控件</strong>：基于属性类型提供正确的控件</li><li><strong>文档自动生成</strong>：从类型注释生成 API 文档</li><li><strong>交互式示例</strong>：提供可交互的组件演示</li></ol><h2 id=组件库使用与集成>组件库使用与集成<a hidden class=anchor aria-hidden=true href=#组件库使用与集成>#</a></h2><p>组件库的使用体验同样需要保持类型安全：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#75715e>// 使用组件库的应用入口
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>ReactDOM</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react-dom&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ThemeProvider</span>, <span style=color:#a6e22e>Button</span>, <span style=color:#a6e22e>Input</span>, <span style=color:#a6e22e>Select</span>, <span style=color:#a6e22e>Table</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;my-ui-library&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#34;my-ui-library/styles.css&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>App</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;./App&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ReactDOM</span>.<span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>ThemeProvider</span> <span style=color:#a6e22e>theme</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;light&#34;</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>App</span> /&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>ThemeProvider</span>&gt;,
</span></span><span style=display:flex><span>  document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;root&#34;</span>)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// App.tsx - 使用组件的应用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span>, { <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Button</span>, <span style=color:#a6e22e>Input</span>, <span style=color:#a6e22e>Select</span>, <span style=color:#a6e22e>Table</span>, <span style=color:#a6e22e>Modal</span>, <span style=color:#a6e22e>Form</span>, <span style=color:#a6e22e>Card</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;my-ui-library&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 类型安全的数据定义
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>email</span>: <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>role</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;admin&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;editor&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;viewer&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;active&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;inactive&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>App</span>: <span style=color:#66d9ef>React.FC</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 类型安全的状态管理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>users</span>, <span style=color:#a6e22e>setUsers</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>&lt;<span style=color:#f92672>User</span><span style=color:#960050;background-color:#1e0010>[]</span>&gt;([
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>1</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;John Doe&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>email</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;john@example.com&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>role</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;admin&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;active&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Jane Smith&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>email</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;jane@example.com&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>role</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;editor&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;active&#34;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  ]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>selectedUser</span>, <span style=color:#a6e22e>setSelectedUser</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>&lt;<span style=color:#f92672>User</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>null</span>&gt;(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>isModalOpen</span>, <span style=color:#a6e22e>setIsModalOpen</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 表格列定义 - 类型安全
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>columns</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Name&#34;</span>, <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;name&#34;</span> },
</span></span><span style=display:flex><span>    { <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;email&#34;</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Email&#34;</span>, <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;email&#34;</span> },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;role&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Role&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;role&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>render</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>role</span>: <span style=color:#66d9ef>User</span>[<span style=color:#e6db74>&#34;role&#34;</span>]) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#e6db74>`role-badge role-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>role</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}&gt;
</span></span><span style=display:flex><span>          {<span style=color:#a6e22e>role</span>.<span style=color:#a6e22e>charAt</span>(<span style=color:#ae81ff>0</span>).<span style=color:#a6e22e>toUpperCase</span>() <span style=color:#f92672>+</span> <span style=color:#a6e22e>role</span>.<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>1</span>)}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>      ),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;status&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Status&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;status&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>render</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>User</span>[<span style=color:#e6db74>&#34;status&#34;</span>]) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#e6db74>`status-indicator status-</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>status</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}&gt;
</span></span><span style=display:flex><span>          {<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;active&#34;</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;Active&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Inactive&#34;</span>}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>span</span>&gt;
</span></span><span style=display:flex><span>      ),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;actions&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Actions&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>render</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>_</span>: <span style=color:#66d9ef>any</span>, <span style=color:#a6e22e>user</span>: <span style=color:#66d9ef>User</span>) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;table-actions&#34;</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Button</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;small&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;secondary&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>handleEditUser</span>(<span style=color:#a6e22e>user</span>)}
</span></span><span style=display:flex><span>          &gt;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Edit</span>
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Button</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;small&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;danger&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>handleDeleteUser</span>(<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>id</span>)}
</span></span><span style=display:flex><span>          &gt;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Delete</span>
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      ),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 类型安全的事件处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleEditUser</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>user</span>: <span style=color:#66d9ef>User</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setSelectedUser</span>(<span style=color:#a6e22e>user</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setIsModalOpen</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleDeleteUser</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>userId</span>: <span style=color:#66d9ef>number</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setUsers</span>(<span style=color:#a6e22e>users</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>user</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>userId</span>));
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleCreateUser</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setSelectedUser</span>(<span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setIsModalOpen</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleSaveUser</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>userData</span>: <span style=color:#66d9ef>Partial</span>&lt;<span style=color:#f92672>User</span>&gt; <span style=color:#f92672>&amp;</span> { <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>; <span style=color:#a6e22e>email</span>: <span style=color:#66d9ef>string</span> }
</span></span><span style=display:flex><span>  ) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectedUser</span>) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 更新现有用户
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>setUsers</span>(
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>users</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>user</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>selectedUser</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>?</span> { ...<span style=color:#a6e22e>user</span>, ...<span style=color:#a6e22e>userData</span> } <span style=color:#f92672>:</span> <span style=color:#a6e22e>user</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建新用户
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>newUser</span>: <span style=color:#66d9ef>User</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>Math.max</span>(<span style=color:#ae81ff>0</span>, ...<span style=color:#a6e22e>users</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>u</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>id</span>)) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>userData.name</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>email</span>: <span style=color:#66d9ef>userData.email</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>role</span>: <span style=color:#66d9ef>userData.role</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;viewer&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>status</span>: <span style=color:#66d9ef>userData.status</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;active&#34;</span>,
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>setUsers</span>([...<span style=color:#a6e22e>users</span>, <span style=color:#a6e22e>newUser</span>]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setIsModalOpen</span>(<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;app-container&#34;</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Card</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;card-header&#34;</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>h2</span>&gt;<span style=color:#a6e22e>User</span> <span style=color:#a6e22e>Management</span>&lt;/<span style=color:#f92672>h2</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;primary&#34;</span> <span style=color:#a6e22e>leftIcon</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;+&#34;</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleCreateUser</span>}&gt;
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Add</span> <span style=color:#a6e22e>User</span>
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Table</span>&lt;<span style=color:#f92672>User</span>&gt; <span style=color:#a6e22e>data</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>users</span>} <span style=color:#a6e22e>columns</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>columns</span>} <span style=color:#a6e22e>bordered</span> <span style=color:#a6e22e>rowKey</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;id&#34;</span> /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Card</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Modal</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>selectedUser</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;Edit User&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Create User&#34;</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>open</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>isModalOpen</span>}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>onClose</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>setIsModalOpen</span>(<span style=color:#66d9ef>false</span>)}
</span></span><span style=display:flex><span>      &gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Form</span>&lt;<span style=color:#f92672>Partial</span>&lt;<span style=color:#f92672>User</span>&gt;&gt;
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>initialValues</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>selectedUser</span> <span style=color:#f92672>||</span> { <span style=color:#a6e22e>role</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;viewer&#34;</span>, <span style=color:#a6e22e>status</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;active&#34;</span> }}
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>onSubmit</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleSaveUser</span>}
</span></span><span style=display:flex><span>        &gt;
</span></span><span style=display:flex><span>          {({ <span style=color:#a6e22e>values</span>, <span style=color:#a6e22e>handleChange</span>, <span style=color:#a6e22e>handleSubmit</span> }) <span style=color:#f92672>=&gt;</span> (
</span></span><span style=display:flex><span>            &lt;&gt;
</span></span><span style=display:flex><span>              &lt;<span style=color:#f92672>Form.Item</span> <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Name&#34;</span> <span style=color:#a6e22e>required</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>Input</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;name&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;&#34;</span>}
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleChange</span>}
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Enter user name&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>required</span>
</span></span><span style=display:flex><span>                /&gt;
</span></span><span style=display:flex><span>              &lt;/<span style=color:#f92672>Form.Item</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              &lt;<span style=color:#f92672>Form.Item</span> <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Email&#34;</span> <span style=color:#a6e22e>required</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>Input</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;email&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>email</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;&#34;</span>}
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleChange</span>}
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Enter email address&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;email&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>required</span>
</span></span><span style=display:flex><span>                /&gt;
</span></span><span style=display:flex><span>              &lt;/<span style=color:#f92672>Form.Item</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              &lt;<span style=color:#f92672>Form.Item</span> <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Role&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>Select</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;role&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>role</span>}
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{(<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>handleChange</span>({
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;role&#34;</span>, <span style=color:#a6e22e>value</span> },
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                &gt;
</span></span><span style=display:flex><span>                  &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;admin&#34;</span>&gt;<span style=color:#a6e22e>Admin</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>                  &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;editor&#34;</span>&gt;<span style=color:#a6e22e>Editor</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>                  &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewer&#34;</span>&gt;<span style=color:#a6e22e>Viewer</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>Select</span>&gt;
</span></span><span style=display:flex><span>              &lt;/<span style=color:#f92672>Form.Item</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              &lt;<span style=color:#f92672>Form.Item</span> <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Status&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>Select</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;status&#34;</span>
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>values</span>.<span style=color:#a6e22e>status</span>}
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{(<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>handleChange</span>({
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;status&#34;</span>, <span style=color:#a6e22e>value</span> },
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                &gt;
</span></span><span style=display:flex><span>                  &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;active&#34;</span>&gt;<span style=color:#a6e22e>Active</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>                  &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;inactive&#34;</span>&gt;<span style=color:#a6e22e>Inactive</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>Select</span>&gt;
</span></span><span style=display:flex><span>              &lt;/<span style=color:#f92672>Form.Item</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-actions&#34;</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ghost&#34;</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>setIsModalOpen</span>(<span style=color:#66d9ef>false</span>)}&gt;
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>Cancel</span>
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>                &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;primary&#34;</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleSubmit</span>}&gt;
</span></span><span style=display:flex><span>                  {<span style=color:#a6e22e>selectedUser</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;Update&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Create&#34;</span>}
</span></span><span style=display:flex><span>                &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>              &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>            &lt;/&gt;
</span></span><span style=display:flex><span>          )}
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>Form</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Modal</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>App</span>;
</span></span></code></pre></div><p>这种集成展示了：</p><ol><li><strong>类型安全的状态管理</strong>：useState 与类型定义结合</li><li><strong>类型安全的表格定义</strong>：表格列与数据模型匹配</li><li><strong>类型安全的表单处理</strong>：表单数据与模型类型匹配</li><li><strong>类型安全的事件处理</strong>：事件处理器接收正确的参数类型</li></ol><h2 id=组件库持续演进策略>组件库持续演进策略<a hidden class=anchor aria-hidden=true href=#组件库持续演进策略>#</a></h2><p>企业组件库需要持续演进以适应业务需求。</p><h3 id=版本控制与向后兼容>版本控制与向后兼容<a hidden class=anchor aria-hidden=true href=#版本控制与向后兼容>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// 处理版本兼容的策略
</span></span></span><span style=display:flex><span><span style=color:#75715e>// DeprecatedProps.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ConsoleSeverity</span>, <span style=color:#a6e22e>printToConsole</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../utils/logger&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 泛型工具类型，用于标记已废弃的属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Deprecated</span><span style=color:#f92672>&lt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Props</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>DeprecatedKeys</span> <span style=color:#66d9ef>extends</span> <span style=color:#66d9ef>keyof</span> <span style=color:#a6e22e>Props</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>NewAPI</span> <span style=color:#66d9ef>extends</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Omit</span>&lt;<span style=color:#f92672>Props</span>, <span style=color:#a6e22e>DeprecatedKeys</span>&gt; <span style=color:#f92672>&amp;</span> {
</span></span><span style=display:flex><span>  [<span style=color:#a6e22e>K</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>DeprecatedKeys</span>]<span style=color:#f92672>?:</span> <span style=color:#a6e22e>Props</span>[<span style=color:#a6e22e>K</span>];
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 特定组件的废弃属性处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>handleDeprecatedProps</span><span style=color:#f92672>&lt;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>P</span> <span style=color:#66d9ef>extends</span> <span style=color:#66d9ef>object</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>D</span> <span style=color:#66d9ef>extends</span> <span style=color:#66d9ef>keyof</span> <span style=color:#a6e22e>P</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>R</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>Omit</span>&lt;<span style=color:#f92672>P</span>, <span style=color:#a6e22e>D</span>&gt;
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>P</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>deprecatedProps</span>: <span style=color:#66d9ef>D</span>[],
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>replacements</span>: <span style=color:#66d9ef>Record</span>&lt;<span style=color:#f92672>string</span>, <span style=color:#a6e22e>string</span>&gt;,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>componentName</span>: <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>R</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> { ...<span style=color:#a6e22e>props</span> } <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>unknown</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>R</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>deprecatedProps</span>.<span style=color:#a6e22e>forEach</span>((<span style=color:#a6e22e>prop</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>prop</span> <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>key</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>props</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>replacement</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>replacements</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;a newer API&#34;</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>printToConsole</span>(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>`Warning: &#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>key</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34; prop of </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>componentName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> is deprecated and will be removed in the next major version. `</span> <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>`Please use </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>replacement</span><span style=color:#e6db74>}</span><span style=color:#e6db74> instead.`</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ConsoleSeverity</span>.<span style=color:#a6e22e>Warn</span>
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 从结果中删除已废弃属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>delete</span> (<span style=color:#a6e22e>result</span> <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>any</span>)[<span style=color:#a6e22e>key</span>];
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用示例:
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Button.tsx中处理废弃的API
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ButtonProps</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;./button.types&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>handleDeprecatedProps</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../utils/DeprecatedProps&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Button</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>ButtonProps</span>&gt; <span style=color:#f92672>=</span> (<span style=color:#a6e22e>props</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理已废弃的属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>processedProps</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>handleDeprecatedProps</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>props</span>,
</span></span><span style=display:flex><span>    [<span style=color:#e6db74>&#34;color&#34;</span>, <span style=color:#e6db74>&#34;raised&#34;</span>], <span style=color:#75715e>// 已废弃的属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;variant&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>raised</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;elevation or variant=&#34;contained&#34;&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Button&#34;</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 使用处理后的属性继续组件逻辑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span></code></pre></div><h3 id=迁移助手与共存策略>迁移助手与共存策略<a hidden class=anchor aria-hidden=true href=#迁移助手与共存策略>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// MigrationHelper.tsx - 帮助渐进迁移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 老版本Button组件类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>LegacyButtonProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>color</span><span style=color:#f92672>?:</span> <span style=color:#e6db74>&#34;primary&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;secondary&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;default&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>raised?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>flat?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onClick?</span>: <span style=color:#66d9ef>React.MouseEventHandler</span>&lt;<span style=color:#f92672>HTMLButtonElement</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children?</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 新版本Button组件类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>NewButtonProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>variant</span><span style=color:#f92672>?:</span> <span style=color:#e6db74>&#34;primary&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;secondary&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;tertiary&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;ghost&#34;</span> <span style=color:#f92672>|</span> <span style=color:#e6db74>&#34;danger&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>elevation?</span>: <span style=color:#66d9ef>0</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>onClick?</span>: <span style=color:#66d9ef>React.MouseEventHandler</span>&lt;<span style=color:#f92672>HTMLButtonElement</span>&gt;;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>disabled?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>children?</span>: <span style=color:#66d9ef>React.ReactNode</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 迁移助手类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>ButtonWithMigrationProps</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>LegacyButtonProps</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>NewButtonProps</span>) <span style=color:#f92672>&amp;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>useLegacy?</span>: <span style=color:#66d9ef>boolean</span>;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 检测是否使用遗留API
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isLegacyProps</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>ButtonWithMigrationProps</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>props</span> <span style=color:#66d9ef>is</span> <span style=color:#a6e22e>LegacyButtonProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;color&#34;</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>props</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;raised&#34;</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>props</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;flat&#34;</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>props</span> <span style=color:#f92672>||</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>!!</span><span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>useLegacy</span>
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 将旧API转换为新API
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>convertLegacyProps</span>(<span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>LegacyButtonProps</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>NewButtonProps</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>color</span>, <span style=color:#a6e22e>raised</span>, <span style=color:#a6e22e>flat</span>, ...<span style=color:#a6e22e>rest</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>props</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 转换逻辑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>variant</span>: <span style=color:#66d9ef>NewButtonProps</span>[<span style=color:#e6db74>&#34;variant&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;primary&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>elevation</span>: <span style=color:#66d9ef>NewButtonProps</span>[<span style=color:#e6db74>&#34;elevation&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>color</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;primary&#34;</span>) <span style=color:#a6e22e>variant</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;primary&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>color</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#34;secondary&#34;</span>) <span style=color:#a6e22e>variant</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;secondary&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#a6e22e>variant</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;tertiary&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>raised</span>) <span style=color:#a6e22e>elevation</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>flat</span>) <span style=color:#a6e22e>elevation</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> { ...<span style=color:#a6e22e>rest</span>, <span style=color:#a6e22e>variant</span>, <span style=color:#a6e22e>elevation</span> };
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 兼容两种API的组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ButtonWithMigration</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>ButtonWithMigrationProps</span>&gt; <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span>
</span></span><span style=display:flex><span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 判断并转换属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>newProps</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>isLegacyProps</span>(<span style=color:#a6e22e>props</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>convertLegacyProps</span>(<span style=color:#a6e22e>props</span>) <span style=color:#f92672>:</span> <span style=color:#a6e22e>props</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 渲染新版本组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>NewButton</span> {<span style=color:#a6e22e>...newProps</span>} /&gt;;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><h2 id=质量保证策略>质量保证策略<a hidden class=anchor aria-hidden=true href=#质量保证策略>#</a></h2><p>组件库需要严格的质量保证。</p><h3 id=单元测试与集成测试>单元测试与集成测试<a hidden class=anchor aria-hidden=true href=#单元测试与集成测试>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// Button.test.tsx - 组件单元测试
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>render</span>, <span style=color:#a6e22e>screen</span>, <span style=color:#a6e22e>fireEvent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@testing-library/react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Button</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../src&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>describe</span>(<span style=color:#e6db74>&#34;Button Component&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;renders correctly with default props&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(&lt;<span style=color:#f92672>Button</span>&gt;<span style=color:#a6e22e>Test</span> <span style=color:#a6e22e>Button</span>&lt;/<span style=color:#f92672>Button</span>&gt;);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByText</span>(<span style=color:#e6db74>&#34;Test Button&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toBeInTheDocument</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveClass</span>(<span style=color:#e6db74>&#34;btn&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveClass</span>(<span style=color:#e6db74>&#34;btn-primary&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveClass</span>(<span style=color:#e6db74>&#34;btn-medium&#34;</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;renders with custom variant and size&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>variant</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;secondary&#34;</span> <span style=color:#a6e22e>size</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;large&#34;</span>&gt;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Custom</span> <span style=color:#a6e22e>Button</span>
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByText</span>(<span style=color:#e6db74>&#34;Custom Button&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveClass</span>(<span style=color:#e6db74>&#34;btn-secondary&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveClass</span>(<span style=color:#e6db74>&#34;btn-large&#34;</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;renders as disabled when disabled prop is true&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(&lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>disabled</span>&gt;<span style=color:#a6e22e>Disabled</span> <span style=color:#a6e22e>Button</span>&lt;/<span style=color:#f92672>Button</span>&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByText</span>(<span style=color:#e6db74>&#34;Disabled Button&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toBeDisabled</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveClass</span>(<span style=color:#e6db74>&#34;btn-disabled&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveAttribute</span>(<span style=color:#e6db74>&#34;aria-disabled&#34;</span>, <span style=color:#e6db74>&#34;true&#34;</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;renders as a link when href is provided&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://example.com&#34;</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span>&gt;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Link</span> <span style=color:#a6e22e>Button</span>
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>link</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByText</span>(<span style=color:#e6db74>&#34;Link Button&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>link</span>.<span style=color:#a6e22e>tagName</span>).<span style=color:#a6e22e>toBe</span>(<span style=color:#e6db74>&#34;A&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>link</span>).<span style=color:#a6e22e>toHaveAttribute</span>(<span style=color:#e6db74>&#34;href&#34;</span>, <span style=color:#e6db74>&#34;https://example.com&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>link</span>).<span style=color:#a6e22e>toHaveAttribute</span>(<span style=color:#e6db74>&#34;target&#34;</span>, <span style=color:#e6db74>&#34;_blank&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>link</span>).<span style=color:#a6e22e>toHaveAttribute</span>(<span style=color:#e6db74>&#34;rel&#34;</span>, <span style=color:#e6db74>&#34;noopener noreferrer&#34;</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;calls onClick handler when clicked&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleClick</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>fn</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(&lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleClick</span>}&gt;<span style=color:#a6e22e>Clickable</span> <span style=color:#a6e22e>Button</span>&lt;/<span style=color:#f92672>Button</span>&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByText</span>(<span style=color:#e6db74>&#34;Clickable Button&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fireEvent</span>.<span style=color:#a6e22e>click</span>(<span style=color:#a6e22e>button</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>handleClick</span>).<span style=color:#a6e22e>toHaveBeenCalledTimes</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;does not call onClick when disabled&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleClick</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>fn</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleClick</span>} <span style=color:#a6e22e>disabled</span>&gt;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Disabled</span> <span style=color:#a6e22e>Button</span>
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByText</span>(<span style=color:#e6db74>&#34;Disabled Button&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>fireEvent</span>.<span style=color:#a6e22e>click</span>(<span style=color:#a6e22e>button</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>handleClick</span>).<span style=color:#a6e22e>not</span>.<span style=color:#a6e22e>toHaveBeenCalled</span>();
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;renders with left and right icons&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Button</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>leftIcon</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>data-testid</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;left-icon&#34;</span>&gt;<span style=color:#a6e22e>L</span>&lt;/<span style=color:#f92672>span</span>&gt;}
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>rightIcon</span><span style=color:#f92672>=</span>{&lt;<span style=color:#f92672>span</span> <span style=color:#a6e22e>data-testid</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;right-icon&#34;</span>&gt;<span style=color:#a6e22e>R</span>&lt;/<span style=color:#f92672>span</span>&gt;}
</span></span><span style=display:flex><span>      &gt;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Icon</span> <span style=color:#a6e22e>Button</span>
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByTestId</span>(<span style=color:#e6db74>&#34;left-icon&#34;</span>)).<span style=color:#a6e22e>toBeInTheDocument</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByTestId</span>(<span style=color:#e6db74>&#34;right-icon&#34;</span>)).<span style=color:#a6e22e>toBeInTheDocument</span>();
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;renders loading state correctly&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>render</span>(&lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>loading</span>&gt;<span style=color:#a6e22e>Loading</span> <span style=color:#a6e22e>Button</span>&lt;/<span style=color:#f92672>Button</span>&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>button</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByText</span>(<span style=color:#e6db74>&#34;Loading Button&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toHaveClass</span>(<span style=color:#e6db74>&#34;btn-loading&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>button</span>).<span style=color:#a6e22e>toBeDisabled</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>screen</span>.<span style=color:#a6e22e>getByRole</span>(<span style=color:#e6db74>&#34;status&#34;</span>)).<span style=color:#a6e22e>toBeInTheDocument</span>(); <span style=color:#75715e>// spinner
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  });
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=可访问性测试>可访问性测试<a hidden class=anchor aria-hidden=true href=#可访问性测试>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// 使用axe进行可访问性测试
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>render</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@testing-library/react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>axe</span>, <span style=color:#a6e22e>toHaveNoViolations</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;jest-axe&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Button</span>, <span style=color:#a6e22e>Select</span>, <span style=color:#a6e22e>Form</span>, <span style=color:#a6e22e>Input</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../src&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>expect</span>.<span style=color:#a6e22e>extend</span>(<span style=color:#a6e22e>toHaveNoViolations</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>describe</span>(<span style=color:#e6db74>&#34;Accessibility Tests&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;Button has no accessibility violations&#34;</span>, <span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>container</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>aria-label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Submit form&#34;</span>&gt;<span style=color:#a6e22e>Submit</span>&lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>results</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>axe</span>(<span style=color:#a6e22e>container</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>results</span>).<span style=color:#a6e22e>toHaveNoViolations</span>();
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;Form elements have no accessibility violations&#34;</span>, <span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>container</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Form</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Form.Item</span> <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Username&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;username-field&#34;</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Input</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;username&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;username&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>aria-describedby</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;username-help&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>required</span>
</span></span><span style=display:flex><span>          /&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>small</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;username-help&#34;</span>&gt;<span style=color:#a6e22e>Enter</span> <span style=color:#a6e22e>your</span> <span style=color:#a6e22e>username</span>&lt;/<span style=color:#f92672>small</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>Form.Item</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Form.Item</span> <span style=color:#a6e22e>label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Country&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;country-field&#34;</span>&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Select</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;country&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;country&#34;</span> <span style=color:#a6e22e>aria-label</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Select your country&#34;</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;us&#34;</span>&gt;<span style=color:#a6e22e>United</span> <span style=color:#a6e22e>States</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ca&#34;</span>&gt;<span style=color:#a6e22e>Canada</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>            &lt;<span style=color:#f92672>Select.Option</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;mx&#34;</span>&gt;<span style=color:#a6e22e>Mexico</span>&lt;/<span style=color:#f92672>Select.Option</span>&gt;
</span></span><span style=display:flex><span>          &lt;/<span style=color:#f92672>Select</span>&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>Form.Item</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;<span style=color:#a6e22e>Submit</span>&lt;/<span style=color:#f92672>Button</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Form</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>results</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>axe</span>(<span style=color:#a6e22e>container</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>results</span>).<span style=color:#a6e22e>toHaveNoViolations</span>();
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=性能测试>性能测试<a hidden class=anchor aria-hidden=true href=#性能测试>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// performance.test.tsx - 性能测试
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>render</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;@testing-library/react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Profiler</span>, <span style=color:#a6e22e>ProfilerOnRenderCallback</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;react&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Button</span>, <span style=color:#a6e22e>Table</span>, <span style=color:#a6e22e>DataGrid</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#34;../src&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 性能测试助手
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>measurePerformance</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Component</span>: <span style=color:#66d9ef>React.ComponentType</span>&lt;<span style=color:#f92672>any</span>&gt;,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>any</span>,
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>iterations</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Promise</span><span style=color:#f92672>&lt;</span>{
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>meanRenderTime</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>firstRender</span>: <span style=color:#66d9ef>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>reRenders</span>: <span style=color:#66d9ef>number</span>[];
</span></span><span style=display:flex><span>}<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Promise</span>((<span style=color:#a6e22e>resolve</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>firstRender</span>: <span style=color:#66d9ef>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>reRenders</span>: <span style=color:#66d9ef>number</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleRender</span>: <span style=color:#66d9ef>ProfilerOnRenderCallback</span> <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>phase</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>actualDuration</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>baseDuration</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>startTime</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>commitTime</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>firstRender</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>firstRender</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>actualDuration</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>reRenders</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>actualDuration</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>reRenders</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>iterations</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 计算均值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mean</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>reRenders</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>firstRender</span><span style=color:#f92672>!</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>iterations</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>resolve</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>meanRenderTime</span>: <span style=color:#66d9ef>mean</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>firstRender</span>: <span style=color:#66d9ef>firstRender</span><span style=color:#f92672>!</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>reRenders</span>,
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 使用Profiler测量组件性能
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>rerender</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Profiler</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;performance-test&#34;</span> <span style=color:#a6e22e>onRender</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleRender</span>}&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Component</span> {<span style=color:#a6e22e>...props</span>} /&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>Profiler</span>&gt;
</span></span><span style=display:flex><span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 进行多次重新渲染以获取更可靠的数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>iterations</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>rerender</span>(
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>Profiler</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;performance-test&#34;</span> <span style=color:#a6e22e>onRender</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleRender</span>}&gt;
</span></span><span style=display:flex><span>          &lt;<span style=color:#f92672>Component</span> {<span style=color:#a6e22e>...props</span>} <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>i</span>} /&gt;
</span></span><span style=display:flex><span>        &lt;/<span style=color:#f92672>Profiler</span>&gt;
</span></span><span style=display:flex><span>      );
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 性能预算阈值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>PERFORMANCE_BUDGETS</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>button</span>: <span style=color:#66d9ef>5</span>, <span style=color:#75715e>// ms
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>table</span>: <span style=color:#66d9ef>50</span>, <span style=color:#75715e>// ms
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>dataGrid</span>: <span style=color:#66d9ef>100</span>, <span style=color:#75715e>// ms
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>describe</span>(<span style=color:#e6db74>&#34;Component Performance Tests&#34;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;Button renders within performance budget&#34;</span>, <span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>results</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>measurePerformance</span>(<span style=color:#a6e22e>Button</span>, {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>children</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Performance Test&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>variant</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;primary&#34;</span>,
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>results</span>.<span style=color:#a6e22e>meanRenderTime</span>).<span style=color:#a6e22e>toBeLessThan</span>(<span style=color:#a6e22e>PERFORMANCE_BUDGETS</span>.<span style=color:#a6e22e>button</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>test</span>(<span style=color:#e6db74>&#34;Table renders within performance budget&#34;</span>, <span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 生成测试数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> Array.<span style=color:#66d9ef>from</span>({ <span style=color:#a6e22e>length</span>: <span style=color:#66d9ef>100</span> }, (<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>i</span>) <span style=color:#f92672>=&gt;</span> ({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>id</span>: <span style=color:#66d9ef>i</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Item </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>i</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>Math.random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>,
</span></span><span style=display:flex><span>    }));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>columns</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Name&#34;</span>, <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;name&#34;</span> },
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>key</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;value&#34;</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;Value&#34;</span>, <span style=color:#a6e22e>dataIndex</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;value&#34;</span> },
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>results</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>measurePerformance</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Table</span>,
</span></span><span style=display:flex><span>      { <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>columns</span> },
</span></span><span style=display:flex><span>      <span style=color:#ae81ff>20</span> <span style=color:#75715e>// 较少的迭代次数用于大型组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>results</span>.<span style=color:#a6e22e>meanRenderTime</span>).<span style=color:#a6e22e>toBeLessThan</span>(<span style=color:#a6e22e>PERFORMANCE_BUDGETS</span>.<span style=color:#a6e22e>table</span>);
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h2 id=项目实际数据与成果>项目实际数据与成果<a hidden class=anchor aria-hidden=true href=#项目实际数据与成果>#</a></h2><p>我们的组件库通过严格的类型安全设计，取得了显著的成果：</p><table><thead><tr><th>指标</th><th>改进前</th><th>改进后</th><th>改进率</th></tr></thead><tbody><tr><td>组件使用错误率</td><td>每周约 85 个</td><td>每周约 6 个</td><td>93%</td></tr><tr><td>开发效率</td><td>每周平均 1.5 个组件</td><td>每周平均 2.5 个组件</td><td>67%</td></tr><tr><td>设计一致性</td><td>约 72%</td><td>约 98%</td><td>36%</td></tr><tr><td>组件复用率</td><td>约 35%</td><td>约 86%</td><td>146%</td></tr><tr><td>开发者满意度</td><td>61%</td><td>94%</td><td>54%</td></tr><tr><td>设计师满意度</td><td>58%</td><td>92%</td><td>59%</td></tr><tr><td>用户访问性评分</td><td>73/100</td><td>96/100</td><td>32%</td></tr><tr><td>代码量减少</td><td>-</td><td>约 63,000 行</td><td>-</td></tr><tr><td>产品开发周期</td><td>平均 8 周</td><td>平均 4.5 周</td><td>44%</td></tr></tbody></table><p>最令人印象深刻的是，通过组件库的类型安全设计，我们的前端团队实现了：</p><ol><li><strong>前端 bug 减少 87%</strong>：类型系统捕获了绝大多数常见错误</li><li><strong>入职时间从 3 周降至 5 天</strong>：新开发者可以更快上手</li><li><strong>客户满意度提升 26%</strong>：由于更一致的用户体验</li></ol><h2 id=结语>结语<a hidden class=anchor aria-hidden=true href=#结语>#</a></h2><p>构建企业级 React 组件库是一项系统工程，需要在类型安全、性能、可访问性和开发体验之间取得平衡。我们的实践证明，以类型安全为第一公民的设计理念，能够显著提高组件库的质量和开发效率。</p><p>通过精心设计的类型系统、严格的质量保证措施和以用户为中心的文档系统，组件库不仅提高了产品的开发效率，还改善了产品的用户体验和可维护性。类型驱动设计让我们能够在编译时捕获大部分错误，而不是在运行时或用户使用过程中才发现问题。</p><p>在组件库设计过程中，我们发现几个关键因素对成功至关重要：</p><ol><li><strong>类型优先设计</strong>：首先设计类型，然后实现组件</li><li><strong>设计系统集成</strong>：将设计令牌转化为类型安全的代码</li><li><strong>渐进式迁移</strong>：支持现有代码库的平滑过渡</li><li><strong>持续质量保证</strong>：严格的自动化测试确保组件可靠性</li><li><strong>优秀的开发体验</strong>：文档和 IDE 集成同样重要</li></ol><p>未来，我们将探索更多前沿技术来增强组件库，包括自动类型生成、AI 辅助组件开发和更强大的设计系统集成。随着 TypeScript 和 React 的持续发展，组件库的可能性也在不断扩展。</p><p>企业级组件库的构建是一次投资，它不仅提升了当前的开发效率，更为企业的长期技术演进奠定了基础。通过类型安全的组件库，我们能够更快地响应业务需求，同时保持卓越的产品质量和一致的用户体验。但是我们也应该意识到，避免重复造轮子。</p><h2 id=相关阅读>相关阅读<a hidden class=anchor aria-hidden=true href=#相关阅读>#</a></h2><ul><li><a href=/zh/posts/architecture-and-performance/>现代前端架构设计与性能优化</a> - 探索前端架构与性能的关系</li><li><a href=/zh/posts/vite-deep-dive/>深入浅出 Vite</a> - 了解新一代构建工具的革命性突破</li><li><a href=/zh/posts/typescript-advanced-types/>TypeScript 高级类型编程实战</a> - 学习 TypeScript 类型系统的高级应用</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.yss520.online/zh/tags/react/>React</a></li><li><a href=https://www.yss520.online/zh/tags/typescript/>TypeScript</a></li><li><a href=https://www.yss520.online/zh/tags/%E7%BB%84%E4%BB%B6%E5%BA%93/>组件库</a></li><li><a href=https://www.yss520.online/zh/tags/%E8%AE%BE%E8%AE%A1%E7%B3%BB%E7%BB%9F/>设计系统</a></li><li><a href=https://www.yss520.online/zh/tags/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/>前端工程化</a></li><li><a href=https://www.yss520.online/zh/tags/%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8/>类型安全</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 构建企业级 React 组件库：类型安全与设计系统的完美融合 on x" href="https://x.com/intent/tweet/?text=%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7%20React%20%e7%bb%84%e4%bb%b6%e5%ba%93%ef%bc%9a%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88&amp;url=https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f&amp;hashtags=React%2cTypeScript%2c%e7%bb%84%e4%bb%b6%e5%ba%93%2c%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%2c%e5%89%8d%e7%ab%af%e5%b7%a5%e7%a8%8b%e5%8c%96%2c%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 构建企业级 React 组件库：类型安全与设计系统的完美融合 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f&amp;title=%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7%20React%20%e7%bb%84%e4%bb%b6%e5%ba%93%ef%bc%9a%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88&amp;summary=%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7%20React%20%e7%bb%84%e4%bb%b6%e5%ba%93%ef%bc%9a%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88&amp;source=https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 构建企业级 React 组件库：类型安全与设计系统的完美融合 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f&title=%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7%20React%20%e7%bb%84%e4%bb%b6%e5%ba%93%ef%bc%9a%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 构建企业级 React 组件库：类型安全与设计系统的完美融合 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 构建企业级 React 组件库：类型安全与设计系统的完美融合 on whatsapp" href="https://api.whatsapp.com/send?text=%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7%20React%20%e7%bb%84%e4%bb%b6%e5%ba%93%ef%bc%9a%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88%20-%20https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 构建企业级 React 组件库：类型安全与设计系统的完美融合 on telegram" href="https://telegram.me/share/url?text=%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7%20React%20%e7%bb%84%e4%bb%b6%e5%ba%93%ef%bc%9a%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88&amp;url=https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 构建企业级 React 组件库：类型安全与设计系统的完美融合 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%e6%9e%84%e5%bb%ba%e4%bc%81%e4%b8%9a%e7%ba%a7%20React%20%e7%bb%84%e4%bb%b6%e5%ba%93%ef%bc%9a%e7%b1%bb%e5%9e%8b%e5%ae%89%e5%85%a8%e4%b8%8e%e8%ae%be%e8%ae%a1%e7%b3%bb%e7%bb%9f%e7%9a%84%e5%ae%8c%e7%be%8e%e8%9e%8d%e5%90%88&u=https%3a%2f%2fwww.yss520.online%2fzh%2fposts%2freact-component-library%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.yss520.online/zh/>Bruce的博客</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=/js/lightbox.js></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>